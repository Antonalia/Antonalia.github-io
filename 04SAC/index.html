

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head><!-- hexo injector head_begin start --><link rel="stylesheet" href="/css/my-avatar.css"><!-- hexo injector head_begin end -->
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/bear.png">
  <link rel="icon" href="/img/bear.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="ä»“é¼ å°ä¹">
  <meta name="keywords" content="">
  
    <meta name="description" content="æœ¬æ–‡æˆ‘å°†ä»‹ç»SAC">
<meta property="og:type" content="article">
<meta property="og:title" content="SACç®—æ³•">
<meta property="og:url" content="http://example.com/04SAC/index.html">
<meta property="og:site_name" content="ä»“é¼ å°ä¹çš„ä¸ªäººåšå®¢">
<meta property="og:description" content="æœ¬æ–‡æˆ‘å°†ä»‹ç»SAC">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-d5fa72ff00bb69449928fba1e6911a8a_1440w.webp">
<meta property="article:published_time" content="2024-09-04T06:51:26.073Z">
<meta property="article:modified_time" content="2024-09-11T04:56:01.318Z">
<meta property="article:author" content="ä»“é¼ å°ä¹">
<meta property="article:tag" content="SACç®—æ³•">
<meta property="article:tag" content="Actor-Criticç®—æ³•">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pic1.zhimg.com/80/v2-d5fa72ff00bb69449928fba1e6911a8a_1440w.webp">
  
  
  
  <title>SACç®—æ³• - ä»“é¼ å°ä¹çš„ä¸ªäººåšå®¢</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/Scroll.css">
<link rel="stylesheet" href="/css/Shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"ğŸ¾","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"HgEYE7ANotcpcNCkkJ3S91rY-MdYXbMMI","app_key":"R0dhXbKyHGpfckjX1TWACSm6","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  
	<script type="text/javascript">
	  /*çª—å£ç›‘è§†*/
	  var originalTitle = document.title;
	  window.onblur = function(){document.title = "ğŸŒå¦³æ˜¯å¿ƒä¸­çš„æ—¥æœˆ~è½åœ¨é€™è£¡~ğŸŒ›"};
	  window.onfocus = function(){document.title = originalTitle};
	</script>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>ä»“é¼ å°ä¹ğŸ¹</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SACç®—æ³•"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        ä»“é¼ å°ä¹
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-04 14:51" pubdate>
          2024å¹´9æœˆ4æ—¥ ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          10k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          86 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">SACç®—æ³•</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äº 2024å¹´9æœˆ11æ—¥ ä¸‹åˆ
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="å‰è¨€">å‰è¨€</h2>
<p>ä¸è¿‡ï¼ŒSACæœ¬èº«ä»‹ç»çš„èƒ½é‡æ¨¡å‹å’Œæœ€å¤§ç†µæ¨¡å‹å†…å®¹å·²ç»èƒ½å¤Ÿå½¢æˆä¸€æ¡å®Œå¤‡çš„é€»è¾‘é“¾äº†ã€‚ä»åŸºæœ¬æ¨¡å‹å¼€å§‹ï¼Œçœ‹çœ‹SACè¿™ä¸€æ¡è·¯å¾„åˆ°åº•å¹²äº†äº›ä»€ä¹ˆå§~</p>
<h2 id="æœ€å¤§ç†µæ¨¡å‹">1ã€æœ€å¤§ç†µæ¨¡å‹</h2>
<h3 id="ä¸ºä»€ä¹ˆè¦ç”¨æœ€å¤§ç†µæ¨¡å‹">1.1 ä¸ºä»€ä¹ˆè¦ç”¨æœ€å¤§ç†µæ¨¡å‹</h3>
<p>ä¼ ç»Ÿçš„å¼ºåŒ–å­¦ä¹ çš„ç›®çš„æ˜¯æ‰¾å‡ºä¸€ä¸ªç­–ç•¥æ¥æœ€å¤§åŒ–å¥–åŠ±ï¼Œå³ç›®æ ‡å‡½æ•°ï¼š</p>
<p><span class="math display">\[
Ï€^*= \arg \max _{\pi}\mathbb {E}_{(st,at)âˆ¼Ï€}[\Sigma_tR(s_t,a_t)]
\]</span> è€Œæœ€å¤§ç†µå¼ºåŒ–å­¦ä¹ æ˜¯åœ¨æœ€å¤§åŒ–å¥–åŠ±çš„åŒæ—¶æœ€å¤§åŒ–ç†µï¼š <span
class="math display">\[
Ï€^*= \arg \max _{\pi}\mathbb {E}_{(st,at)âˆ¼Ï€}[\Sigma_tR(s_t,a_t)+\alpha
H(\pi(Â·|s_t))]
\]</span></p>
<blockquote>
<p>ä¿¡æ¯ç†µçš„å…¬å¼ä¸ºï¼š<span
class="math inline">\(H(X)=âˆ’\sum_{i=1}^np(x_i)logâ¡p(x_i)\)</span>
ç”¨æ¥è¡¨ç¤º</p>
</blockquote>
<p>è¿™æ ·å­åšæœ‰å‡ ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li><strong>åŠ å¼ºæ¢ç´¢</strong>ã€‚åˆ©ç”¨ç†µè®©æ¯ä¸€æ­¥çš„å†³ç­–å¢åŠ éšæœºæ€§ï¼Œç›¸å½“äºå¼ºåŒ–äº†RLä¸­çš„æ¢ç´¢ã€‚è¿™ä¸€æ–¹é¢èƒ½å¤ŸåŠ é€Ÿä¹‹åçš„å­¦ä¹ ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥é˜²æ­¢ç­–ç•¥è¿‡æ—©åœ°æ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£ã€‚</li>
<li><strong>å˜ç¡®å®šæ€§ç­–ç•¥ä¸ºéšæœºç­–ç•¥</strong>ã€‚å­¦è¿‡åšå¼ˆè®ºçš„å°ä¼™ä¼´å¯èƒ½çŸ¥é“ï¼Œåœ¨è¿›è¡Œåšå¼ˆæ—¶ä¸€ä¸ªäººçš„æœ€ä¼˜ç­–ç•¥å¾€å¾€æ˜¯æ··åˆç­–ç•¥ï¼Œå³éšæœºç­–ç•¥å¾€å¾€æ˜¯æœ€ä¼˜ç­–ç•¥ã€‚å¢åŠ ç†µå¯ä»¥å¢å¼ºç­–ç•¥çš„éšæœºæ€§ï¼Œä»è€Œæœ‰åŠ©äºæ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ã€‚</li>
<li><strong>ä½œä¸ºå¤æ‚ä»»åŠ¡çš„åˆå§‹åŒ–</strong>ã€‚æœ€å¤§ç†µç­–ç•¥ä¸ä»…å­¦åˆ°ä¸€ä¸ªç­–ç•¥ï¼Œè¿˜èƒ½å¤Ÿæ•è·åˆ°æ‰€æœ‰çš„è¡Œä¸ºæ¨¡å¼ï¼Œè¿™ç±»ä¼¼äºCVã€NLPä¸­é¢„è®­ç»ƒçš„æƒ³æ³•ï¼Œå…ˆè®­ç»ƒä¸€ä¸ªæ•è·åˆ°å¾ˆå¤šæ¨¡å¼çš„æ¨¡å‹ï¼Œå†å¾®è°ƒå‚æ•°åº”ç”¨åˆ°è‡ªå·±çš„æ¨¡å‹ï¼Œè¿™å¤§å¤§åŠ å¿«äº†è®­ç»ƒçš„é€Ÿåº¦ã€‚</li>
<li><strong>åŠ å¼º<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E9%B2%81%E6%A3%92%E6%80%A7&amp;zhida_source=entity&amp;is_preview=1">é²æ£’æ€§</a></strong>ã€‚ä»…ä»…æœ€å¤§åŒ–å¥–åŠ±çš„è¯ï¼Œç­–ç•¥å€¾å‘äºåªæ‰¾åˆ°ä¸€æ¡è·¯å¾„ï¼Œå¦‚æœè¿™æ¡è·¯å¾„çŸ­äº†ï¼Œé‚£ç­–ç•¥çš„è¡¨ç°å°±ä¼šè¿…é€Ÿä¸‹é™ï¼›è€Œæœ€å¤§ç†µç­–ç•¥å¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„è¡Œä¸ºæ¨¡å¼ï¼Œå°±ç®—ä¸€æ¡è·¯å¾„æ–­äº†ï¼Œè¿˜å¯ä»¥ä»å¦ä¸€æ¡è·¯å¾„è¾¾åˆ°åŒæ ·çš„ç»“æœã€‚</li>
</ul>
<h3 id="sacçš„æœ€å¤§ç†µæ¨¡å‹çš„ä¸åŒä¹‹å¤„">1.2 SACçš„æœ€å¤§ç†µæ¨¡å‹çš„ä¸åŒä¹‹å¤„</h3>
<p>å…¶å®ï¼Œåœ¨SACä¹‹å‰ï¼Œå¾ˆå¤šå¼ºåŒ–å­¦ä¹ ç®—æ³•éƒ½ç”¨åˆ°äº†ç†µä½œä¸ºæ­£åˆ™åŒ–å‚æ•°æ¥å¢å¼ºç­–ç•¥çš„æ¢ç´¢ã€‚</p>
<p>A3Cï¼š</p>
<p>âˆ‡Î¸â€²logâ¡Ï€(atâˆ£st;Î¸â€²)(Rtâˆ’V(st;Î¸v))+Î²âˆ‡Î¸â€²H(Ï€(st;Î¸â€²))</p>
<p>PPOï¼š</p>
<p>LtCLIP+VF+S(Î¸)=E^t[LtCLIP(Î¸)âˆ’c1LtVF(Î¸)+c2H[Ï€Î¸](st)]</p>
<p>PGQLï¼š</p>
<p>Î”Î¸âˆEs,aQÏ€(s,a)âˆ‡Î¸logâ¡Ï€(s,a)+Î±Eâˆ‡Î¸HÏ€(s)s</p>
<p>Â class Student: Â  Â def <strong>init</strong>(self): Â  Â  Â  Â self._age
= 20 Â  Â <span class="citation" data-cites="property">@property</span> Â 
Â def age(self): Â  Â  Â  Â return self._ageâ€‹â€‹student = Student()â€‹#
è®¾ç½®å±æ€§student.age = 18'''æŠ¥é”™ï¼šproperty 'age' of 'Student' object has
no setter'''â€‹# è·å–å±æ€§ï¼Œprint('å­¦ç”Ÿå¹´é¾„ä¸ºï¼š' +
str(student.age))"""è¾“å‡ºå­¦ç”Ÿå¹´é¾„ä¸ºï¼š20"""â€‹#åªæœ‰é€šè¿‡å†…éƒ¨å±æ€§æ‰èƒ½æ›´æ”¹å€¼ï¼Œæ›´åŠ å®‰å…¨student._age
= 18print('å­¦ç”Ÿå¹´é¾„ä¸ºï¼š' +
str(student.age))"""è¾“å‡ºå­¦ç”Ÿå¹´é¾„ä¸ºï¼š18"""â€‹python</p>
<blockquote>
<p>è¿™ä¸ªåœ°æ–¹ä¹Ÿæœ‰äººè®¤ä¸ºSACçš„ç†µç»è¿‡ç­–ç•¥<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E6%A2%AF%E5%BA%A6%E5%AE%9A%E7%90%86&amp;zhida_source=entity&amp;is_preview=1">æ¢¯åº¦å®šç†</a>æ¨å¯¼ä¹‹åç­‰ä»·äºA3Cçš„ç†µï¼Œä¸è¿‡æ— è®ºå¦‚ä½•ï¼ŒSACçš„æ–‡ç« çœŸæ­£ä»ç†è®ºä¸Šåˆ†æäº†VQÏ€ä¸­ç†µçš„å­˜åœ¨æ€§å’Œå¯è¡Œæ€§</p>
</blockquote>
<h3 id="ä»è´å°”æ›¼æ–¹ç¨‹ç†è§£æœ€å¤§ç†µæ¨¡å‹çš„å€¼å‡½æ•°">1.3 ä»<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E8%B4%9D%E5%B0%94%E6%9B%BC%E6%96%B9%E7%A8%8B&amp;zhida_source=entity&amp;is_preview=1">è´å°”æ›¼æ–¹ç¨‹</a>ç†è§£æœ€å¤§ç†µæ¨¡å‹çš„å€¼å‡½æ•°</h3>
<blockquote>
<p>å€Ÿç”¨äº†ä¸‹<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/70360272">è¿™ä¸ª</a>ç”»çš„å›¾</p>
</blockquote>
<p><strong>1ï¼‰</strong>é¦–å…ˆçœ‹çœ‹æ™®é€šå¼ºåŒ–å­¦ä¹ çš„ç›®æ ‡å‡½æ•°ï¼š <span
class="math display">\[
\pi^{*}=\arg \max _{\pi} \mathbb{E}_{\left(s_{t}, a_{t}\right) \sim
\rho_{\pi}}\left[\sum_{t} R\left(s_{t}, a_{t}\right)\right]
\]</span></p>
<p>å…¶è´å°”æ›¼æ–¹ç¨‹ä¸ºï¼š</p>
<p><span class="math display">\[
Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right) \leftarrow
r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim p, \mathbf{a}_{t+1} \sim
\pi}\left[Q\left(\mathbf{s}_{t+1}, \mathbf{a}_{t+1}\right)\right]
\]</span></p>
<p><img
src="https://pic1.zhimg.com/v2-c6f4a72b394358378732c312ab1e19a2_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>å›æº¯å›¾</p>
<p>ä»å›æº¯å›¾çš„è§’åº¦ï¼Œå®¹æ˜“çœ‹åˆ°æ ‘çš„æ ¹ç»“ç‚¹<span
class="math inline">\(q_{\pi}(s, a)\)</span> å®é™…ä¸Šå°±æ˜¯<span
class="math inline">\(r\)</span>ä¸ $q_{}(s^{}, a^{}) $çš„æœŸæœ›çš„å’Œã€‚</p>
<p><strong>2ï¼‰</strong>å†çœ‹çœ‹æœ€å¤§ç†µå¼ºåŒ–å­¦ä¹ çš„ç›®æ ‡å‡½æ•°ï¼š <span
class="math display">\[
\pi^{*}=\arg \max _{\pi} \mathbb{E}_{\left(s_{t}, a_{t}\right) \sim
p_{\pi}}[\sum_{t} \underbrace{R\left(s_{t}, a_{t}\right)}_{\text {reward
}}+\alpha \underbrace{H\left(\pi\left(\cdot \mid
s_{t}\right)\right)}_{\text {entropy }}]
\]</span></p>
<blockquote>
<p>è¿™ä¸ª <span class="math inline">\(\alpha\)</span>
æ˜¯æ¸©åº¦ç³»æ•°ï¼Œç”¨æ¥è¡¡é‡ç†µé¡¹çš„é‡è¦ç¨‹åº¦ï¼Œåé¢çš„æ¨å¯¼ä¸­å¦‚æœæ²¡æœ‰å†™è¿™ä¸€é¡¹çš„è¯æ˜¯å› ä¸ºé»˜è®¤å€¼ä¸º1ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªç†µæ˜¯åŠ åœ¨<strong>çŠ¶æ€</strong>ä¸Šçš„ï¼Œå’ŒåŠ¨ä½œæ— å…³ã€‚åæ˜ åˆ°å›æº¯å›¾ä¸­ï¼Œå°±æ˜¯ï¼š</p>
<p><img
src="https://pic3.zhimg.com/v2-adba9e16e4c9c8ea31635a9a1abd3946_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>åŠ äº†ç†µçš„å›æº¯å›¾</p>
<p>ç±»æ¯”ä¸€ä¸‹ï¼Œå¯ä»¥æŠŠ$H ((|s^)) <span
class="math inline">\(çœ‹ä½œæ˜¯çŠ¶æ€ä»·å€¼å‡½æ•°ï¼ŒæŠŠ\)</span>(a_{t+1}|s_{t+1}
)<span class="math inline">\(çœ‹ä½œåŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œé‚£ä¹ˆï¼š\)</span>$ H
((|s_{t+1}))=-<em>{a</em>{t+1} A}p(a_{t+1}|s_{t+1})(a_{t+1}|s_{t+1}
)=-<em>{a</em>{t+1} }(a_{t+1}|s_{t+1} ) $$
å³åœ¨ä¸€ä¸ªçŠ¶æ€ä¸‹çš„ç†µ=åœ¨è¿™ä¸ªçŠ¶æ€ä¸‹å¯¹äºæ¯ä¸€ä¸ªåŠ¨ä½œçš„å¯èƒ½æ€§è¿›è¡Œæ±‚æœŸæœ›ï¼Œå†åæ˜ åˆ°å›æº¯å›¾ä¸­ï¼Œå°±å¯ä»¥çœ‹åˆ°ç†µå’Œqæ˜¯å¯ä»¥å†™åœ¨ä¸€èµ·çš„ï¼š</p>
<p><img
src="https://pica.zhimg.com/v2-47d34a96b5f91423bad44b7b3b2c5cb6_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>ç†µæ‹†è§£åçš„å›æº¯å›¾</p>
<p>äºæ˜¯è´å°”æ›¼æ–¹ç¨‹å¯ä»¥å†™ä¸ºï¼š</p>
<p><span class="math display">\[
Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right) \leftarrow
r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim p, \mathbf{a}_{t+1} \sim
\pi}\left[Q\left(\mathbf{s}_{t+1}, \mathbf{a}_{t+1}\right)-\log
\pi\left(\mathbf{a}_{t+1} \mid \mathbf{s}_{t+1}\right)\right]
\]</span> è€Œæˆ‘ä»¬çŸ¥é“åœ¨ä¹‹å‰çš„å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œè´å°”æ›¼æ–¹ç¨‹ä¸­Qä¸Vçš„å…³ç³»æ˜¯ï¼š</p>
<p><span class="math display">\[
Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right) \triangleq
r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[V\left(\mathbf{s}_{t+1}\right)\right]
\]</span> <span
class="math inline">\(p=p(s_{t+1}|s_t)\)</span>å³ä»çŠ¶æ€<span
class="math inline">\(s_{t}\)</span>è½¬ç§»åˆ°<span
class="math inline">\(s_{t+1}\)</span>çš„çŠ¶æ€è½¬ç§»åˆ†å¸ƒæˆ–æ¦‚ç‡å‡½æ•°ï¼Œå°±æ˜¯çŠ¶æ€è½¬ç§»çš„æ¦‚ç‡ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹æ¯”ä»¥ä¸Šä¸¤å¼ï¼Œå°±å¯ä»¥å®šä¹‰<span
class="math inline">\(V\)</span>å‡½æ•°ï¼š</p>
<p><span class="math display">\[
r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim p, \mathbf{a}_{t+1} \sim
\pi}\left[Q\left(\mathbf{s}_{t+1}, \mathbf{a}_{t+1}\right)-\log
\pi\left(\mathbf{a}_{t+1} \mid
\mathbf{s}_{t+1}\right)\right]=r\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)+\gamma \mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[V\left(\mathbf{s}_{t+1}\right)\right]
\\
\gamma \mathbb{E}_{\mathbf{s}_{t+1} \sim p, \mathbf{a}_{t+1} \sim
\pi}\left[Q\left(\mathbf{s}_{t+1}, \mathbf{a}_{t+1}\right)-\log
\pi\left(\mathbf{a}_{t+1} \mid \mathbf{s}_{t+1}\right)\right]=\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[V\left(\mathbf{s}_{t+1}\right)\right]
\\
V\left(\mathbf{s}_{t}\right)=\mathbb{E}_{\mathbf{a}_{t} \sim
\pi}\left[Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)-\log
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right)\right]
\]</span></p>
<h3 id="ç›´æ¥ä»å…¬å¼ç†è§£å€¼å‡½æ•°">1.4 ç›´æ¥ä»å…¬å¼ç†è§£å€¼å‡½æ•°</h3>
<p>1.3èŠ‚ä»è´å°”æ›¼æ–¹ç¨‹çš„è§’åº¦ç†è§£äº†å€¼å‡½æ•°ä¹‹é—´çš„å…³ç³»ï¼Œä¸è¿‡è¯´åˆ°åº•è¿˜æ˜¯å›¾åƒåŒ–çš„ç†è§£ï¼Œä»å…¬å¼çš„è§’åº¦å‡ºå‘å…¶å®å¯ä»¥ç›´æ¥å®šä¹‰å‡ºæ¥<span
class="math inline">\(Qã€V\)</span>ï¼Œå°±æ˜¯æ²¡1.3é‚£ä¹ˆå¥½ç†è§£è€Œå·²ã€‚ä¸è¿‡ä»ä¸¥è°¨æ€§çš„è§’åº¦ï¼Œå…¬å¼åŒ–çš„å®šä¹‰æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p>
<p>1ï¼‰é¦–å…ˆçœ‹çœ‹æ ‡å‡†çš„<span
class="math inline">\(Qã€V\)</span>å‡½æ•°ï¼Œå…¶è¢«å®šä¹‰ä¸ºæ¡ä»¶åŒ–çš„ç´¯ç§¯å¥–åŠ±ï¼š
<span class="math display">\[
Q_{\pi}(s, a)=\underset{s_{t}, a_{t} \sim
\pi}{\mathbb{E}}\left[\sum_{t=0}^{\infty} \gamma^{t} r\left(s_{t},
a_{t}\right) \mid s_{0}=s, a_{0}=a\right]
\\
V_{\pi}(s)=\underset{s_{t}, a_{t} \sim
\pi}{\mathbb{E}}\left[\sum_{t=0}^{\infty} \gamma^{t}\left(r\left(s_{t},
a_{t}\right)\right) \mid s_{0}=s\right]
\]</span></p>
<p>2ï¼‰ç±»ä¼¼çš„ï¼Œå¯ä»¥å®šä¹‰å‡ºæœ€å¤§ç†µç‰ˆæœ¬çš„Qå’ŒVï¼š <span class="math display">\[
\begin{aligned} Q_{s o f t}^{\pi}(s, a) =\underset{s_{t}, a_{t} \sim
\rho_{\pi}}{\mathbb{E}}\left[\sum_{t=0}^{\infty} \gamma^{t}
r\left(s_{t}, a_{t}\right)+\alpha \sum_{t=1}^{\infty} \gamma^{t}
H\left(\pi\left(\cdot \mid s_{t}\right)\right) \mid s_{0}=s,
a_{0}=a\right] \end{aligned}
\]</span></p>
<p><span class="math display">\[
V_{s o f t}^{\pi}(s)=\underset{s_{t}, a_{t} \sim
\rho_{\pi}}{\mathbb{E}}\left[\sum_{t=0}^{\infty}
\gamma^{t}\left(r\left(s_{t}, a_{t}\right)+\alpha H\left(\pi\left(\cdot
\mid s_{t}\right)\right)\right) \mid s_{0}=s\right]
\]</span></p>
<p>ä»Qçš„å®šä¹‰å‡ºå‘ï¼ŒåŒæ ·å¯ä»¥æ¨å‡ºè´å°”æ›¼æ–¹ç¨‹ï¼š</p>
<p><span class="math display">\[
\begin{aligned} Q_{s o f t}^{\pi}(s, a)
&amp;=\underset{\substack{s^{\prime} \sim p\left(s^{\prime} \mid s,
a\right) \\ a^{\prime} \sim \pi}}{\mathbb{E}}\left[r(s,
a)+\gamma\left(Q_{\text {soft }}^{\pi}\left(s^{\prime},
a^{\prime}\right)+\alpha H\left(\pi\left(\cdot \mid
s^{\prime}\right)\right)\right)\right] \\ &amp;=\underset{s^{\prime}
\sim p\left(s^{\prime} \mid s, a\right)}{\mathbb{E}}\left[r(s, a)+\gamma
V_{s o f t}^{\pi}\left(s^{\prime}\right)\right] \end{aligned}
\]</span></p>
<p>å…¶ä¸­</p>
<p><span class="math display">\[
\begin{aligned} V_{s o f t}^{\pi}(s) &amp;=\mathbb{E}_{a \sim
\pi}\left[Q_{s o f t}^{\pi}(s, a)\right]+\alpha H(\pi(\cdot \mid s))
\\&amp;=\mathbb{E}_{a \sim \pi}\left[Q_{s o f t}^{\pi}(s,
a)\right]-\alpha \mathbb{E}_{a \sim \pi}\left[(\log \pi(a \mid s)
\right]\\ &amp;=\underset{a \sim \pi}{\mathbb{E}}\left[Q_{s o f
t}^{\pi}(s, a)-\alpha \log \pi(a \mid s)\right] \end{aligned}
\]</span></p>
<blockquote>
<p>ä¸Šé¢çš„æœ€å¤§ç†µQã€Vçš„å®šä¹‰ç”¨åœ¨SACä¸­ï¼Œè€ŒSoft Q
Learningä¸€å¼€å§‹ç”¨çš„æ˜¯å¦ä¸€å¥—å¼å­</p>
</blockquote>
<h3 id="ç­–ç•¥çš„å½¢å¼">1.5 ç­–ç•¥çš„å½¢å¼</h3>
<p>åœ¨1.3ã€1.4èŠ‚æˆ‘ä»¬çŸ¥é“äº†å€¼å‡½æ•°çš„å½¢å¼ï¼Œé—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„è¿˜æ˜¯è¦å¾—åˆ°ä¸€ä¸ªç­–ç•¥ï¼Œé‚£<strong>ç­–ç•¥æ˜¯ä»€ä¹ˆå½¢å¼å‘¢ï¼Ÿ</strong></p>
<p>è¿˜è®°å¾—ä»·å€¼å‡½æ•°<span class="math inline">\(V\)</span>çš„è¡¨ç¤ºä¸ï¼Ÿ</p>
<p><span class="math display">\[
V\left(\mathbf{s}_{t}\right)=\mathbb{E}_{\mathbf{a}_{t} \sim
\pi}\left[Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)-\alpha \log
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right)\right]
\]</span> ä»<span
class="math inline">\(V\)</span>çš„è¡¨è¾¾å¼ä¸­å¯ä»¥åè§£å‡º<span
class="math inline">\(\pi\)</span>çš„å½¢å¼ï¼Œç§»é¡¹åå¯å¾—ï¼š</p>
<p><span class="math display">\[
\mathbb{E}_{\mathbf{a}_{t} \sim \pi}\left[Q\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-\alpha\log \pi\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)-V\left(\mathbf{s}_{t}\right)\right]=0
\]</span> <strong>å…¶ä¸­ä¸€ä¸ªè§£ä¸º</strong> <span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right) &amp;=\exp
\left(\frac{1}{\alpha}\left(Q_{s o f t}\left(s_{t}, a_{t}\right)-V_{s o
f t}\left(s_{t}\right)\right)\right) \\ &amp;=\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)} \end{aligned}
\]</span></p>
<p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ç­–ç•¥çš„å½¢å¼ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œç­–ç•¥çš„å½¢å¼ä¸ä¸€å®šæ˜¯è¿™ä¸ªï¼Œä½†æ˜¯<strong>è¿™æ ·çš„ç­–ç•¥ä¸€å®šæ»¡è¶³æœ€å¤§ç†µçš„å€¼å‡½æ•°çº¦æŸï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç›´æ¥é‡‡ç”¨è¿™ç§å½¢å¼çš„ç­–ç•¥æ¥è¿›è¡Œç­–ç•¥è¿­ä»£ã€‚</strong></p>
</blockquote>
<h3 id="çŠ¶æ€ä»·å€¼å‡½æ•°vçš„å¦ä¸€ç§å½¢å¼"><strong>1.6
çŠ¶æ€ä»·å€¼å‡½æ•°Vçš„å¦ä¸€ç§å½¢å¼</strong></h3>
<p>æ³¨æ„åˆ°1.5èŠ‚æ¨å¯¼å‡ºçš„ç­–ç•¥å½¢å¼ï¼š <span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right) =\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)} \end{aligned}
\]</span></p>
<p>ç”±äºç­–ç•¥æ‰€æœ‰åŠ¨ä½œæ¦‚ç‡ç§¯åˆ†ä¸º1ï¼š</p>
<p><span class="math display">\[
\int\pi\left(s_{t}|a_{t}\right)d \mathbf{a} =\frac{\int\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)d a}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)}=1
\]</span></p>
<p>å¯ä»¥ç›´æ¥å¾—åˆ°<span class="math inline">\(V\)</span>ä¸<span
class="math inline">\(Q\)</span>çš„ç¬¬äºŒç§å…³ç³»ï¼š</p>
<p><span class="math display">\[
V_{\text {soft }}\left(s_{t}\right) \triangleq \alpha \log \int \exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t}, a\right)\right) d a
\]</span></p>
<blockquote>
<p><strong>æ³¨æ„ï¼Œè¿™ç§Vå’ŒQçš„å…³ç³»çš„å‰æåœ¨äºï¼Œç­–ç•¥Ï€å–1.5èŠ‚æ¨å¯¼å‡ºçš„ç‰¹æ®Šå½¢å¼ã€‚</strong>
<strong>è¿™ä¹Ÿæ˜¯Soft Q Learningä¸­é‡‡ç”¨çš„å½¢å¼</strong></p>
</blockquote>
<p>å°†ä¸Šå¼å›ä»£å¾—<span
class="math inline">\(\pi\left(s_{t}|a_{t}\right)\)</span>çš„å¦ä¸€ç§å½¢å¼ï¼š
<span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right)=\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)} =\frac{\exp \left(\frac{1}{\alpha} Q_{\text
{soft }}\left(s_{t}, a_{t}\right)\right)}{ \int \exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t}, a\right)\right) d
\mathbf{a}} \end{aligned}
\]</span></p>
<h3 id="æœ€ä¼˜ç­–ç•¥"><strong>1.7 æœ€ä¼˜ç­–ç•¥</strong></h3>
<p>æ³¨æ„åˆ°æœ€å¤§ç†µçš„ç­–ç•¥å°±æ˜¯æœ€å¤§åŒ–<span
class="math inline">\(V\)</span>çš„ç­–ç•¥ï¼Œå› æ­¤ç›´æ¥å¯¹<span
class="math inline">\(V\)</span>æ±‚<span
class="math inline">\(\pi\)</span>çš„æ³›å‡½å¯¼æ•°ï¼Œä»¤å…¶ä¸º0ï¼Œå¾—åˆ°çš„å°±æ˜¯æœ€ä¼˜ç­–ç•¥ï¼š</p>
<p><span class="math display">\[
Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)-\alpha\log
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right)-\alpha=0
\\
\begin{aligned} \pi\left(s_{t}|a_{t}\right) =\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{e} \end{aligned}
\]</span> åˆå› ä¸º</p>
<p><span class="math display">\[
\int\pi\left(s_{t}|a_{t}\right)d \mathbf{a} =\frac{\int\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)d a}{e}=1
\\
\int\exp \left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right) da=e
\]</span></p>
<p>å°†åˆ†æ¯ä¸­çš„eç”¨ä¸Šå¼ä»£æ›¿ï¼Œæ‰€ä»¥</p>
<p><span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right) =\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{ \int \exp \left(\frac{1}{\alpha} Q_{\text {soft
}}\left(s_{t}, a\right)\right) d \mathbf{a}} \end{aligned}
\]</span></p>
<p>è€Œ1.6èŠ‚æ¨å‡ºçš„ç¬¦åˆæ¡ä»¶çš„ç­–ç•¥å½¢å¼ä¸ºï¼š</p>
<p><span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right)=\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)} =\frac{\exp \left(\frac{1}{\alpha} Q_{\text
{soft }}\left(s_{t}, a_{t}\right)\right)}{ \int \exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t}, a\right)\right) d
\mathbf{a}} \end{aligned}
\]</span> ç¬¦åˆæœ€ä¼˜ç­–ç•¥çš„å½¢å¼</p>
<p>å› æ­¤ï¼Œ<strong>1.5èŠ‚æ¨å‡ºçš„ç­–ç•¥æ˜¯æœ€ä¼˜ç­–ç•¥ã€‚</strong></p>
<p><strong>åˆå› ä¸ºåœ¨Soft Q
Learingè®ºæ–‡é™„å½•ä¸­çš„A.2ï¼Œæœ€ä¼˜ç­–ç•¥æ˜¯å”¯ä¸€çš„ã€‚</strong></p>
<p><strong>å› æ­¤ï¼Œ1.5èŠ‚æ¨å‡ºçš„ç­–ç•¥æ˜¯å”¯ä¸€çš„æœ€ä¼˜ç­–ç•¥ã€‚</strong></p>
<p><strong>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œå…¨åˆ†ææ¨å¯¼äº†æœ€å¤§ç†µæ¡†æ¶ä¸‹çš„ä»·å€¼å‡½æ•°Vã€Qï¼Œç­–ç•¥Ï€çš„å½¢å¼ã€‚</strong></p>
<h2 id="èƒ½é‡æ¨¡å‹"><strong>2ã€èƒ½é‡æ¨¡å‹</strong></h2>
<p>è¿˜è®°å¾—æœ€å¤§ç†µæ¨¡å‹ä¸­æ¨å¯¼å‡ºçš„<strong>æœ€ä¼˜ç­–ç•¥å½¢å¼</strong>ä¸ï¼Ÿ</p>
<p><span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right) =\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)} \end{aligned}
\]</span></p>
<p><strong>è¿™åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ</strong></p>
<p><strong>Soft Q
Learningä¸­è¯´å®ƒæ˜¯èƒ½é‡æ¨¡å‹ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªä¸œè¥¿å°±æ˜¯èƒ½é‡æ¨¡å‹äº†ï¼Ÿ</strong></p>
<p>åœ¨æ¨å¯¼å®Œå…¬å¼ä¹‹åï¼Œè¿˜å¾—äº†è§£æˆ‘ä»¬æ¨å¯¼çš„åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œè¿™å°±æ˜¯è¿™èŠ‚éœ€è¦è®²çš„èƒ½é‡æ¨¡å‹äº†ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨èƒ½é‡æ¨¡å‹">2.1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨èƒ½é‡æ¨¡å‹ï¼Ÿ</h3>
<p>è¯´åˆ°èƒ½é‡æ¨¡å‹ï¼Œå°±ä¸å¾—ä¸ææ·±åº¦å­¦ä¹ ä¸‰å·¨å¤´ä¹‹ä¸€çš„<strong>Yann
LeCun</strong>äº†ã€‚å…¶å‡­å€Ÿç€èƒ½é‡æ¨¡å‹åœ¨ç”Ÿæˆæ¨¡å‹é¢†åŸŸå¤§è¡Œå…¶é“ï¼Œå¹¶æå‡ºäº†â€œèƒ½é‡æ¨¡å‹æ˜¯é€šå‘è‡ªä¸»äººå·¥æ™ºèƒ½ç³»ç»Ÿçš„èµ·ç‚¹â€ã€â€œå·²ç»åšå¥½æ”¾å¼ƒæ¦‚ç‡è®ºçš„å‡†å¤‡â€ç­‰è¨€è®ºã€‚</p>
<p>æ‰€ä»¥ä¸ºä»€ä¹ˆä»–è¿™ä¹ˆæ¨å´‡èƒ½é‡æ¨¡å‹å‘¢ï¼Ÿ</p>
<p>ç”¨ä»–<a
href="https://link.zhihu.com/?target=http%3A//yann.lecun.com/exdb/publis/orig/lecun-06.pdf">ç»¼è¿°</a>é‡Œçš„è¯æ¥è¯´ï¼Œå°±æ˜¯ï¼š</p>
<blockquote>
<p>åŸºäºèƒ½é‡çš„å­¦ä¹ ä¸ºè®¸å¤šæ¦‚ç‡å’Œéæ¦‚ç‡çš„å­¦ä¹ æ–¹æ³•æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼Œç‰¹åˆ«æ˜¯å›¾æ¨¡å‹å’Œå…¶ä»–ç»“æ„åŒ–æ¨¡å‹çš„éæ¦‚ç‡è®­ç»ƒã€‚<strong>åŸºäºèƒ½é‡çš„å­¦ä¹ å¯ä»¥è¢«çœ‹ä½œæ˜¯é¢„æµ‹ã€åˆ†ç±»æˆ–å†³ç­–ä»»åŠ¡çš„æ¦‚ç‡ä¼°è®¡çš„æ›¿ä»£æ–¹æ³•</strong>ã€‚ç”±äº<strong>ä¸éœ€è¦é€‚å½“çš„å½’ä¸€åŒ–</strong>ï¼ŒåŸºäºèƒ½é‡çš„æ–¹æ³•é¿å…äº†æ¦‚ç‡æ¨¡å‹ä¸­ä¸ä¼°è®¡å½’ä¸€åŒ–å¸¸æ•°ç›¸å…³çš„é—®é¢˜ã€‚æ­¤å¤–ï¼Œç”±äºæ²¡æœ‰æ ‡å‡†åŒ–æ¡ä»¶ï¼Œåœ¨å­¦ä¹ æœºå™¨çš„è®¾è®¡ä¸­å…è®¸äº†æ›´å¤šçš„çµæ´»æ€§ã€‚å¤§å¤šæ•°æ¦‚ç‡æ¨¡å‹éƒ½å¯ä»¥çœ‹ä½œæ˜¯ç‰¹æ®Šç±»å‹çš„åŸºäºèƒ½é‡çš„æ¨¡å‹ï¼Œå…¶ä¸­èƒ½é‡å‡½æ•°æ»¡è¶³ä¸€å®šçš„å½’ä¸€åŒ–æ¡ä»¶ï¼Œ<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0&amp;zhida_source=entity&amp;is_preview=1">æŸå¤±å‡½æ•°</a>é€šè¿‡å­¦ä¹ ä¼˜åŒ–ï¼Œå…·æœ‰ç‰¹å®šçš„å½¢å¼ã€‚</p>
</blockquote>
<h3 id="èƒ½é‡æ¨¡å‹çš„å«ä¹‰">2.2 èƒ½é‡æ¨¡å‹çš„å«ä¹‰</h3>
<p>å¯¹äºåŸºæœ¬çš„èƒ½é‡å‡½æ•°è€Œè¨€ï¼Œç»™å®šä¸€ä¸ª X ï¼Œæ¨¡å‹äº§ç”Ÿä¸ X æœ€å…¼å®¹çš„Y</p>
<p><span class="math display">\[
Y^*=\arg\min_{Y\in\mathcal{Y}} E(Y,X)\\
\]</span></p>
<p>å…¶ä¸­â€œæœ€å…¼å®¹â€æ˜¯æŒ‡ï¼š==å°èƒ½é‡å€¼==å¯¹åº”äºå˜é‡çš„==é«˜åº¦å…¼å®¹==ï¼Œè€Œ==å¤§èƒ½é‡å€¼==å¯¹åº”äºå˜é‡çš„==é«˜åº¦ä¸å…¼å®¹==ã€‚</p>
<p>å³èƒ½é‡å‡½æ•°è¦æ»¡è¶³ä¸‹é¢çš„æ€§è´¨ï¼š</p>
<p><strong>ç»™å®šä¸€ä¸ª<span
class="math inline">\(X\)</span>ï¼Œè¾“å‡ºçš„æœ€ä¼˜<span
class="math inline">\(Y\)</span>å€¼è®©èƒ½é‡å‡½æ•°æœ€å°</strong></p>
<blockquote>
<p>èƒ½é‡å‡½æ•°åœ¨ä¸åŒçš„æŠ€æœ¯ç¤¾åŒºä¸­æœ‰ä¸åŒçš„åç§°ï¼›å®ƒä»¬å¯ä»¥è¢«ç§°ä¸ºå¯¹æ¯”å‡½æ•°ã€ä»·å€¼å‡½æ•°æˆ–è´Ÿå¯¹æ•°<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0&amp;zhida_source=entity&amp;is_preview=1">ä¼¼ç„¶å‡½æ•°</a>ã€‚<br />
èƒ½é‡å‡½æ•°å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œåªè¦æ»¡è¶³æœ€ä¼˜çš„<span
class="math inline">\(Y\)</span>èƒ½è®©èƒ½é‡æœ€å°å³å¯ã€‚<br />
ä¸¾ä¸ªä¾‹å­ï¼Œç›‘ç£å­¦ä¹ ä¸­çš„å›¾ç‰‡ä¸º<span
class="math inline">\(X\)</span>ï¼Œæ ‡ç­¾ä¸º<span
class="math inline">\(Y_0ï¼ˆXï¼‰\)</span>ï¼Œèƒ½é‡æ¨¡å‹<span
class="math inline">\(Eï¼ˆXï¼ŒYï¼‰=ï¼ˆY-Y_0ï¼ˆX))^2\)</span>ï¼Œè¾“å‡ºçš„Yè¶Šæ¥è¿‘X
çš„æ ‡ç­¾ï¼Œèƒ½é‡è¶Šä½ã€‚æ­¤æ—¶ç›‘ç£å­¦ä¹ çš„losså°±æ˜¯èƒ½é‡å‡½æ•°</p>
</blockquote>
<h3 id="èƒ½é‡å‡½æ•°çš„å»ºæ¨¡">2.3 èƒ½é‡å‡½æ•°çš„å»ºæ¨¡</h3>
<p>å¯¹äºå†³ç­–ä»»åŠ¡ï¼Œä¾‹å¦‚æ“çºµæœºå™¨äººï¼Œåªéœ€è¦ç³»ç»Ÿç»™äºˆæ­£ç¡®ç­”æ¡ˆå°±èƒ½è·å¾—æœ€ä½çš„èƒ½é‡ï¼Œå…¶ä»–ç­”æ¡ˆè·å¾—çš„æ›´å¤§èƒ½é‡æ— å…³ç´§è¦ï¼ˆæ¯”å¦‚RLä¸­æˆ‘ä»¬åªéœ€è¦é€‰æ‹©èƒ½é‡æœ€ä½çš„actionå³å¯ï¼‰ã€‚ç„¶è€Œï¼Œä¸€ä¸ªç³»ç»Ÿçš„è¾“å‡ºæœ‰æ—¶å¿…é¡»ä¸å¦ä¸€ä¸ªç³»ç»Ÿçš„è¾“å‡ºç›¸ç»“åˆï¼Œæˆ–è€…æä¾›ç»™å¦ä¸€ä¸ªç³»ç»Ÿä½œä¸ºè¾“å…¥(æˆ–è€…æä¾›ç»™äººç±»å†³ç­–è€…)ã€‚å”¯ä¸€ä¸€è‡´çš„æ–¹æ³•æ˜¯å°†æ‰€æœ‰å¯èƒ½è¾“å‡ºçš„èƒ½é‡è½¬æ¢æˆä¸€ä¸ªæ ‡å‡†åŒ–çš„æ¦‚ç‡åˆ†å¸ƒã€‚æœ€ç®€å•ã€æœ€å¸¸ç”¨çš„æ–¹æ³•å³è½¬åŒ–ä¸ºGibbsåˆ†å¸ƒï¼ˆåˆå«åš<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E7%8E%BB%E5%B0%94%E5%85%B9%E6%9B%BC%E5%88%86%E5%B8%83&amp;zhida_source=entity&amp;is_preview=1">ç»å°”å…¹æ›¼åˆ†å¸ƒ</a>ï¼‰ï¼š</p>
<p><span class="math display">\[
P(Y \mid X)=\frac{e^{-\beta E(Y, X)}}{\int_{y \in \mathcal{Y}} e^{-\beta
E(y, X)}}
\]</span></p>
<blockquote>
<p>ç»å°”å…¹æ›¼åˆ†å¸ƒæ˜¯ä¸€ç§æ¦‚ç‡åˆ†å¸ƒï¼Œå®ƒç»™å‡ºä¸€ä¸ªç³»ç»Ÿå¤„äºæŸç§çŠ¶æ€çš„æœºç‡ï¼Œè¯¥å‡ ç‡æ˜¯æ­¤çŠ¶æ€ä¸‹çš„èƒ½é‡åŠæ¸©åº¦çš„å‡½ã€‚ç»™å‡ºä¸ºï¼š<br />
<span class="math display">\[
p_{i} \propto e^{-\varepsilon_{i} /(k T)}
\\
p_{i}=\frac{1}{Q} e^{-\varepsilon_{i} /(k T)}=\frac{e^{-\varepsilon_{i}
/(k T)}}{\sum_{j=1}^{M} e^{-\varepsilon_{j} /(k T)}}*
\]</span></p>
<p>å…¶ä¸­ <em><span class="math inline">\(\varepsilon\)</span></em>
è¡¨ç¤ºèƒ½é‡ï¼Œ<strong>k</strong>æ˜¯<strong><a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=ç»å°”å…¹æ›¼å¸¸æ•°&amp;zhida_source=entity&amp;is_preview=1">ç»å°”å…¹æ›¼å¸¸æ•°</a></strong>ï¼Œ<strong>T</strong>æ˜¯ç³»ç»Ÿçš„ç»å¯¹æ¸©åº¦ï¼Œ<strong>M</strong>æ˜¯ç³»ç»Ÿå¯è®¿é—®çš„æ‰€æœ‰çŠ¶æ€çš„æ•°é‡ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œèƒ½é‡è¶Šä½ï¼Œè¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šé«˜ï¼Œå³è¢«é€‰ä¸­çš„åŠ¨ä½œè¶Šä¼˜ã€‚</p>
<p>è¿™æ»¡è¶³èƒ½é‡å‡½æ•°çš„æ€§è´¨ï¼Œæ‰€ä»¥<strong>ç»å°”å…¹æ›¼åˆ†å¸ƒæ˜¯åŸºäºèƒ½é‡çš„åˆ†å¸ƒ</strong></p>
<h3 id="åŸºäºèƒ½é‡çš„å¼ºåŒ–å­¦ä¹ "><strong>2.4 åŸºäºèƒ½é‡çš„å¼ºåŒ–å­¦ä¹ </strong></h3>
<p><strong>ç»ˆäºå¯ä»¥çŸ¥é“æœ€å¤§ç†µæ¨¡å‹ä¸­çš„æœ€ä¼˜ç­–ç•¥çš„å«ä¹‰æ˜¯ä»€ä¹ˆäº†ï¼š</strong></p>
<p><span class="math display">\[
\begin{aligned} \pi\left(s_{t}|a_{t}\right) =\frac{\exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t},
a_{t}\right)\right)}{\exp \left(\frac{1}{\alpha} V_{\text {soft
}}\left(s_{t}\right)\right)}=\frac{\exp \left(\frac{1}{\alpha} Q_{\text
{soft }}\left(s_{t}, a_{t}\right)\right)}{ \int \exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t}, a\right)\right) d
\mathbf{a}} \end{aligned}
\]</span> å¦‚æœå–èƒ½é‡å‡½æ•°ï¼š</p>
<p><span class="math display">\[
\mathcal{E}\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)=-\frac{1}{\alpha}
Q_{\operatorname{soft}}\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)
\]</span> å†è®©ç­–ç•¥æ­£æ¯”äºè´Ÿèƒ½é‡ï¼š</p>
<p><span class="math display">\[
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right) \propto \exp
\left(-\mathcal{E}\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)\right)
\]</span> è¿™ä¸å°±æ˜¯ç»å°”å…¹æ›¼åˆ†å¸ƒå—ï¼Ÿå…¶ä¸­ä¸å­˜åœ¨æ¸©åº¦<span
class="math inline">\(kT\)</span>å¯¹ç³»ç»Ÿæ¦‚ç‡çš„å½±å“ã€‚</p>
<p>æ‰€ä»¥<strong>æœ€å¤§ç†µå¼ºåŒ–å­¦ä¹ ä¸­çš„æœ€ä¼˜ç­–ç•¥å½¢å¼æ˜¯ç»å°”å…¹æ›¼åˆ†å¸ƒ</strong>ï¼Œå…¶ä¸­$
$æ˜¯æ¸©åº¦ç³»æ•°ã€‚ <span class="math inline">\(\alpha\)</span>
è¶Šå¤§ï¼Œå„ä¸ªåŠ¨ä½œè¢«é€‰ä¸­çš„æ¦‚ç‡å·®å°±è¶Šå°ï¼Œè¶Šæ¥è¿‘éšæœºç­–ç•¥ï¼› <span
class="math inline">\(\alpha\)</span>
è¶Šå°ï¼Œå„ä¸ªåŠ¨ä½œè¢«é€‰ä¸­çš„æ¦‚ç‡å·®å°±è¶Šå¤§ï¼Œè¶Šæ¥è¿‘ç¡®å®šæ€§ç­–ç•¥ã€‚é€šè¿‡è°ƒèŠ‚ <span
class="math inline">\(\alpha\)</span> å¯ä»¥è°ƒèŠ‚ç­–ç•¥çš„éšæœºæ€§æ¢ç´¢ã€‚</p>
<blockquote>
<p>æŠŠå¼ºåŒ–å­¦ä¹ çš„ç­–ç•¥å»ºæ¨¡ä¸ºç»å°”å…¹æ›¼åˆ†å¸ƒçš„æƒ³æ³•ä¹‹å‰å°±æœ‰è¿‡å¾ˆå¤šï¼Œå¹¶è¢«ç§°ä¸ºç»å°”å…¹æ›¼æ¢ç´¢ï¼Œè¿™æ ·å­åšæœ‰ä¸ªå¥½å¤„å°±æ˜¯ç”¨éšæœºç­–ç•¥å¯ä»¥åŠ å¼ºæ¢ç´¢ï¼Œå¹¶ä¸”æ»¡è¶³<span
class="math inline">\(Q\)</span>è¶Šå¤§è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šå¤§çš„æ¡ä»¶ã€‚</p>
</blockquote>
<h3 id="èƒ½é‡ç­–ç•¥çš„å¥½å¤„">2.5 èƒ½é‡ç­–ç•¥çš„å¥½å¤„</h3>
<p>è¿™æ—¶å€™å°±è¦ç¥­å‡º<a
href="https://link.zhihu.com/?target=https%3A//bair.berkeley.edu/blog/2017/10/06/soft-q-learning/">è¿™å¼ </a>ç»å…¸çš„å›¾äº†ï¼š</p>
<p><img
src="https://picx.zhimg.com/v2-9a97eee9111031a967cf5823b07087ef_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>èƒ½é‡ç­–ç•¥</p>
<p>ä¼ ç»Ÿçš„åŸºäºé«˜æ–¯åˆ†å¸ƒçš„ç­–ç•¥åªèƒ½æ•è·å•å³°çš„Qå€¼ï¼Œä¹Ÿå°±æ˜¯åªèƒ½æ•è·ä¸€ç§è¡Œä¸ºæ¨¡å¼ï¼Œè¿™ç§ç»å°”å…¹æ›¼åˆ†å¸ƒçš„èƒ½é‡ç­–ç•¥èƒ½å¤Ÿæ•è·å¤šä¸ªè¡Œä¸ºæ¨¡å¼ï¼Œå¤§å¤§å¢å¼ºäº†è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p>ç»è¿‡å‰é¢ä¸€å¤§é€šçš„æ¨å¯¼ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»ç†è§£äº†åŸºäºæœ€å¤§ç†µå’Œèƒ½é‡æ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶ï¼Œä¹ŸçŸ¥é“äº†å…¶ä¸­å€¼å‡½æ•°ã€ç­–ç•¥çš„è¡¨è¾¾å¼ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæ ¹æ®è¿™ä¸ªæ¡†æ¶ï¼Œå¯ä»¥å¯¼å‡ºä¸¤ä¸ªç®—æ³•ã€‚</p>
<p>ç¬¬ä¸€ç§ï¼Œå°±æ˜¯ç±»ä¼¼Q Learningé£æ ¼çš„ï¼ŒSoft Q Learningã€‚</p>
<h3 id="soft-å€¼è¿­ä»£">3.1 Soft å€¼è¿­ä»£</h3>
<p>å†æ¬¡è¯·å‡ºæˆ‘ä»¬çš„Qå’ŒVå‡½æ•°ï¼š</p>
<p><span class="math display">\[
\begin{aligned} Q_{s o f t}(s, a) =\underset{s^{\prime} \sim
p\left(s^{\prime} \mid s, a\right)}{\mathbb{E}}\left[r(s, a)+\gamma V_{s
o f t}\left(s^{\prime}\right)\right] \end{aligned}
\]</span></p>
<p><span class="math display">\[
V_{\text {soft }}\left(s_{t}\right) \triangleq \alpha \log \int \exp
\left(\frac{1}{\alpha} Q_{\text {soft }}\left(s_{t}, a\right)\right) d
\mathbf{a}
\]</span></p>
<p>é‚£ä¹ˆå¦‚ä½•è¿­ä»£æ›´æ–°å¾—åˆ°ä»–ä»¬å‘¢ï¼Ÿ</p>
<p>åªéœ€è¦æŠŠâ€œ=â€å·æ”¹æˆè¿­ä»£çš„å½¢å¼å³å¯ï¼š</p>
<p><span class="math display">\[
\begin{aligned} &amp;Q_{\mathrm{soft}}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right) \leftarrow r_{t}+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim
p_{\mathbf{s}}}\left[V_{\mathrm{soft}}\left(\mathbf{s}_{t+1}\right)\right],
\forall \mathbf{s}_{t}, \mathbf{a}_{t}
\\&amp;V_{\mathrm{soft}}\left(\mathbf{s}_{t}\right) \leftarrow \alpha
\log \int_{\mathcal{A}} \exp \left(\frac{1}{\alpha}
Q_{\mathrm{soft}}\left(\mathbf{s}_{t}, \mathbf{a}^{\prime}\right)\right)
d \mathbf{a}^{\prime}, \forall \mathbf{s}_{t} \end{aligned}
\]</span></p>
<blockquote>
<p>æ”¶æ•›æ€§è¯æ˜è§<a
href="https://link.zhihu.com/?target=http%3A//proceedings.mlr.press/v70/haarnoja17a/haarnoja17a.pdf">SQLé™„å½•</a>ï¼Œæ€è·¯æ˜¯åˆ©ç”¨<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/458151225">å‹ç¼©æ˜ å°„</a>çš„è¯æ˜æ–¹å¼ã€‚</p>
</blockquote>
<p>åªè¦ä¸æ–­åœ°è¿™ä¹ˆæ›´æ–°ï¼Œå€¼å‡½æ•°å°±ä¼šæ”¶æ•›ã€‚</p>
<h3 id="å‚æ•°åŒ–çš„soft-å€¼ä¼˜åŒ–">3.2 å‚æ•°åŒ–çš„Soft å€¼ä¼˜åŒ–</h3>
<p>åœ¨ç¦»æ•£çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦è¿›è¡Œsoft ä»·å€¼è¿­ä»£å°±è¡Œäº†ã€‚</p>
<p>ä¸ºäº†è¿›ä¸€æ­¥å¢å¼ºå€¼å‡½æ•°çš„è¡¨ç¤ºèƒ½åŠ›ï¼Œå¯ä»¥å°†å…¶ç”¨ <span
class="math inline">\(\theta\)</span> å‚æ•°åŒ–ï¼ˆä¾‹å¦‚ç¥ç»ç½‘ç»œå‚æ•°ï¼‰å˜æˆ
<span
class="math inline">\(Q_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\)</span>å’Œ $V_{}^{}(_{t})
$ï¼Œä½¿å…¶é€‚åº”è¿ç»­çš„çŠ¶æ€ç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥ä¼˜åŒ–ã€‚</p>
<p>Vï¼š</p>
<p>æ±‚Vçš„è¯éœ€è¦å¯¹åŠ¨ä½œè¿›è¡Œç§¯åˆ†ï¼Œè¿™åœ¨åŠ¨ä½œç©ºé—´ç‰¹åˆ«å¤§æˆ–è€…è¿ç»­åŠ¨ä½œç©ºé—´çš„æ—¶å€™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘ä½¿ç”¨<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E9%87%8D%E8%A6%81%E6%80%A7%E9%87%87%E6%A0%B7&amp;zhida_source=entity&amp;is_preview=1">é‡è¦æ€§é‡‡æ ·</a>å¯¹å…¶åˆ†å¸ƒè¿›è¡Œä¼°è®¡ï¼š</p>
<p><span class="math display">\[
V_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t}\right)=\alpha \log
\mathbb{E}_{q_{\mathbf{a}^{\prime}}}\left[\frac{\exp
\left(\frac{1}{\alpha} Q_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t},
\mathbf{a}^{\prime}\right)\right)}{q_{\mathbf{a}^{\prime}}\left(\mathbf{a}^{\prime}\right)}\right]
\]</span></p>
<p>$q_{^{}} $
çš„è¯å¯ä»¥æ˜¯ä»»æ„åˆ†å¸ƒï¼ŒåˆæœŸå¯ä»¥ç”¨éšæœºåˆ†å¸ƒï¼Œåé¢å¯ä»¥ç”¨å½“å‰ç­–ç•¥ã€‚</p>
<p>Qï¼š</p>
<p>æ±‚Qçš„è¯åªéœ€è¦ç±»ä¼¼DQNçš„æ›´æ–°å°±è¡Œäº†ï¼š</p>
<p><span class="math display">\[
J_{Q}(\theta)=\mathbb{E}_{\mathbf{s}_{t} \sim q_{\mathrm{s}_{t}},
\mathbf{a}_{t} \sim
q_{\mathbf{a}_{t}}}\left[\frac{1}{2}\left(\hat{Q}_{\mathrm{soft}}^{\bar{\theta}}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-Q_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\right)^{2}\right]
\]</span></p>
<p>å…¶ä¸­</p>
<p><span class="math display">\[
\hat{Q}_{\mathrm{soft}}^{\bar{\theta}}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)=r_{t}+\gamma \mathbb{E}_{\mathbf{s}_{t+1} \sim
p_{\mathrm{s}}}\left[V_{\mathrm{soft}}^{\bar{\theta}}\left(\mathbf{s}_{t+1}\right)\right]
\]</span></p>
<p>å¯¹ä»–ä»¬è¿›è¡Œéšæœºæ¢¯åº¦ä¸‹é™å°±è¡Œäº†ã€‚</p>
<p><span
class="math inline">\(q_{\mathrm{s}_{t}}\)</span>æ˜¯å½“å‰ç­–ç•¥ã€‚</p>
<p><strong>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜</strong>ï¼Œç­–ç•¥è¡¨ç¤ºæ˜¯ç»å°”å…¹æ›¼åˆ†å¸ƒï¼š <span
class="math display">\[
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right) \propto\exp
\left(\frac{1}{\alpha} Q_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\right)
\]</span></p>
<p>å¦‚æœæ˜¯<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E7%A6%BB%E6%95%A3%E7%A9%BA%E9%97%B4&amp;zhida_source=entity&amp;is_preview=1">ç¦»æ•£ç©ºé—´</a>è¿˜å¥½ï¼Œ<strong>è¿ç»­ç©ºé—´æ€ä¹ˆä»è¿™ä¸ªç»å°”å…¹æ›¼åˆ†å¸ƒè¿›è¡ŒæŠ½æ ·å‘¢</strong>ï¼Ÿ</p>
<p>æ¢è¨€ä¹‹ï¼Œ<strong>ç»å°”å…¹æ›¼åˆ†å¸ƒæ€ä¹ˆç”¨ç­–ç•¥è¡¨ç¤ºå‘¢</strong>ï¼Ÿ</p>
<h3 id="ç­–ç•¥çš„è¿‘ä¼¼é‡‡æ ·">3.3 ç­–ç•¥çš„è¿‘ä¼¼é‡‡æ ·</h3>
<p>ä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªå¯ä»¥ç”¨æ¥è¡¨ç¤ºç­–ç•¥çš„ç½‘ç»œæ¥ä»£æ›¿ç»å°”å…¹æ›¼åˆ†å¸ƒçš„ç­–ç•¥è¿›è¡Œé‡‡æ ·ã€‚éšååˆ©ç”¨KLæ•£åº¦æ¥ç¼©å°ç”¨ç­–ç•¥ç½‘ç»œ<span
class="math inline">\(\pi^\phi\)</span>ä¸åŸºäºèƒ½é‡çš„ç­–ç•¥ä¹‹é—´çš„å·®è·ï¼š</p>
<p><span class="math display">\[
\begin{aligned} J_{\pi}\left(\phi ; \mathbf{s}_{t}\right)=
\mathrm{D}_{\mathrm{KL}}\left(\pi^{\phi}\left(\cdot \mid
\mathbf{s}_{t}\right) \| \exp
\left(\frac{1}{\alpha}\left(Q_{\mathrm{soft}}^{\theta}\left(\mathbf{s}_{t},
\cdot\right)-V_{\mathrm{soft}}^{\theta}\right)\right)\right)
\end{aligned}
\]</span></p>
<p>ä½œè€…ç”¨äº†<a
href="https://link.zhihu.com/?target=https%3A//proceedings.neurips.cc/paper/2016/file/b3ba8f1bee1238a2f37603d90b58898d-Paper.pdf">å˜åˆ†æ¢¯åº¦ä¸‹é™</a>è¿›è¡Œä¼˜åŒ–ã€‚</p>
<blockquote>
<p>ä¸è¿‡è¿™ç§é‡‡æ ·ç½‘ç»œåœ¨SACçš„æ—¶å€™è¢«å¼ƒæ‰äº†ï¼Œä¼°è®¡å¯èƒ½æ˜¯åˆå¤æ‚åˆç”¨å¤„ä¸å¤§</p>
</blockquote>
<p>è¿™ä¸ªé‡‡æ ·ç½‘ç»œçš„å­˜åœ¨å¯ä»¥çœ‹åšæ˜¯actor-criticä¸­çš„actorã€‚</p>
<h3 id="soft-q-learning">3.4 Soft Q Learning</h3>
<p>OKï¼Œç°åœ¨ä»·å€¼å‡½æ•°å’Œç­–ç•¥çš„é‡‡æ ·æ›´æ–°æ–¹å¼éƒ½æœ‰äº†ï¼Œå°±å¯ä»¥å†™ç®—æ³•äº†ï¼š</p>
<p><img
src="https://pica.zhimg.com/v2-51c51ebd61a203d36115fc0ca51b765e_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>soft q learning</p>
<h2 id="soft-actor-critic">4ã€Soft Actor Critic</h2>
<p>åˆ°äº†å–œé—»ä¹è§çš„SACç¯èŠ‚ã€‚</p>
<h3 id="soft-ç­–ç•¥è¿­ä»£policy-iteration">4.1 Soft ç­–ç•¥è¿­ä»£ï¼ˆPolicy
Iterationï¼‰</h3>
<p>é¦–å…ˆå…ˆä»‹ç»ä¸€ä¸‹ <strong>Policy Iteration</strong>ï¼š å®ƒæ˜¯ä¸€ç§åœ¨ Policy
Evaluation å’Œ Policy Improvement
ä¸­äº¤æ›¿è¿­ä»£æ›´æ–°çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚ç”¨å¤§ç™½è¯æ¥è®²çš„è¯ï¼ŒPolicy
Evaluationå°±æ˜¯åœ¨ä¼°è®¡æŸä¸ªçŠ¶æ€æ‰§è¡ŒæŸä¸ªåŠ¨ä½œå¹³å‡èƒ½è·å¾—å¤šå°‘å›æŠ¥ï¼›è€ŒPolicy
Improvement åˆ™æ˜¯å°†ç­–ç•¥è°ƒæ•´ä¸ºæ‰§è¡Œå½“å‰çŠ¶æ€å…·æœ‰æ›´å¤§å›æŠ¥çš„åŠ¨ä½œã€‚</p>
<p>SAC<strong>æŠ›å¼ƒäº†å¯¹åŠ¨ä½œè¿›è¡Œç§¯åˆ†çš„Vå‡½æ•°</strong>ï¼š <span
class="math inline">\(V_{\text {soft }}\left(s_{t}\right) \triangleq
\alpha \log \int \exp \left(\frac{1}{\alpha} Q_{\text {soft
}}\left(s_{t}, a\right)\right) d \mathbf{a}\)</span></p>
<p>é‡‡ç”¨äº†å¦ä¸€ç§Vå‡½æ•°ï¼š <span class="math display">\[
V\left(\mathbf{s}_{t}\right)=\mathbb{E}_{\mathbf{a}_{t} \sim
\pi}\left[Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)-\log
\pi\left(\mathbf{a}_{t} \mid \mathbf{s}_{t}\right)\right]
\]</span></p>
<blockquote>
<p>è¿™æ ·åšå°±æ¶ˆé™¤äº†Vå¯¹åŠ¨ä½œç§¯åˆ†éš¾çš„é—®é¢˜</p>
</blockquote>
<p>åˆ©ç”¨å¼ºåŒ–å­¦ä¹ ä¸­çš„<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/541571513">ç­–ç•¥è¿­ä»£</a>æ–¹æ³•ï¼Œæ¯æ¬¡ç­–ç•¥æ”¹è¿›å¾—åˆ°æ›´å¥½çš„ç­–ç•¥ï¼Œç„¶åä¸ºæ–°ç­–ç•¥è¯„ä¼°ä¸€ä¸ªä»·å€¼å‡½æ•°ï¼Œç„¶åç»§ç»­æ”¹è¿›ç­–ç•¥ï¼Œä»¥æ­¤ç±»æ¨ã€‚å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥ã€‚</p>
<p>1ï¼‰<strong>ç­–ç•¥ä¼°è®¡ï¼ˆPolicy Evaluationï¼‰</strong></p>
<p>é¦–å…ˆéœ€è¦äº†è§£è´å°”æ›¼æ–¹ç¨‹ï¼š <span class="math display">\[
Q(s_t,a_t)=r(s_t,a_t)+\gamma\sum_{s^{\prime}\in
S}P(s^{\prime}|s)V(s^{\prime})=r(s_t,a_t)+\gamma\mathbb{E}_{\mathbf{s}_{t+1}\sim
p}\left[V(\mathbf{s}_{t+1})\right]
\]</span> å¯¹å…¶==è€ƒè™‘ç†µ==ï¼Œå®šä¹‰ä¸€ä¸ªè€ƒè™‘ç†µçš„<span
class="math inline">\(Q(s,a)\)</span>ä¸º <span
class="math inline">\(\mathcal{T}^Ï€ Q ( s_t , a_t
)\)</span>ã€‚<del>ä¸æ–­å¯¹ä»·å€¼å‡½æ•°è¿ç”¨è´å°”æ›¼ç®—å­ï¼Œä»·å€¼å‡½æ•°å°±èƒ½å¤Ÿæ”¶æ•›åˆ°ç­–ç•¥<span
class="math inline">\(\pi\)</span>ä¸‹çš„ä»·å€¼ä¼°è®¡ï¼š</del> <span
class="math display">\[
\mathcal{T}^{\pi} Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)
\triangleq r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[V\left(\mathbf{s}_{t+1}\right)\right]ï¼Œå…¶ä¸­V(\mathbf{s}_{t+1})=\mathbb{E}_{\mathbf{a}_{t+1}\sim\pi}\left[Q(\mathbf{s}_{t+1},\mathbf{a}_{t+1})-\log\pi(\mathbf{a}_{t+1}|\mathbf{s}_{t+1})\right]
\]</span></p>
<p><span class="math display">\[
\mathcal{T}^{\pi} Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)
\triangleq r\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim
p,{\mathbf{a}_{t+1}}\sim\pi}\left[Q(\mathbf{s}_{t+1},\mathbf{a}_{t+1})-\log\pi(\mathbf{a}_{t+1}|\mathbf{s}_{t+1})\right]
\]</span></p>
<blockquote>
<p>è¯æ˜ï¼šæŠŠå¥–åŠ±<span
class="math inline">\(r\)</span>å’Œç†µå†™åˆ°ä¸€èµ·ï¼Œå› æ­¤æœ€å¤§ç†µç›®æ ‡å˜æˆäº†åŒ…å«ç†µçš„å¥–åŠ±ï¼š
<span class="math display">\[
r_{\pi}\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right) \triangleq
r\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)+\mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[\mathcal{H}\left(\pi\left(\cdot \mid
\mathbf{s}_{t+1}\right)\right)\right]
\]</span> è€Œè¿™ç§ä¿®æ”¹äº†çš„å¥–åŠ±å½¢å¼æ°å¥½ç¬¦åˆç­–ç•¥ä¼°è®¡çš„<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/541571513">æ”¶æ•›è¯æ˜</a>ï¼š<br />
<span class="math display">\[
Q\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right) \leftarrow
r_{\pi}\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)+\gamma
\mathbb{E}_{\mathbf{s}_{t+1} \sim p, \mathbf{a}_{t+1} \sim
\pi}\left[Q\left(\mathbf{s}_{t+1}, \mathbf{a}_{t+1}\right)\right]
\]</span> æ‰€ä»¥ä»·å€¼å‡½æ•°æ”¶æ•›</p>
</blockquote>
<p>2ï¼‰<strong>ç­–ç•¥æ”¹è¿›ï¼ˆPolicy Improvementï¼‰</strong></p>
<p>åœ¨1ã€2èŠ‚æˆ‘ä»¬çŸ¥é“ï¼Œ<strong>æœ€ä¼˜ç­–ç•¥æ˜¯é‡‡ç”¨ç»å°”å…¹æ›¼åˆ†å¸ƒèƒ½é‡å½¢å¼çš„ç­–ç•¥</strong></p>
<p>SACåˆ©ç”¨è¿™ä¸€ç‚¹æ¥æ›´æ–°ç­–ç•¥<strong>ï¼š</strong></p>
<p><span class="math display">\[
\pi_{\text {new }}=\arg \min _{\pi^{\prime} \in \Pi}
\mathrm{D}_{\mathrm{KL}}\left(\pi^{\prime}\left(\cdot \mid
\mathbf{s}_{t}\right) \| \frac{\exp
\left(Q^{\pi_{\mathrm{old}}}\left(\mathbf{s}_{t},
\cdot\right)\right)}{Z^{\pi_{\text {old
}}}\left(\mathbf{s}_{t}\right)}\right)
\]</span></p>
<p>ä½†æ˜¯å¹¶æ²¡æœ‰ç›´æ¥é‡‡ç”¨ç»å°”å…¹æ›¼åˆ†å¸ƒï¼Œè€Œæ˜¯é€šè¿‡é«˜æ–¯åˆ†å¸ƒæ¥è¿‘ä¼¼ç»å°”å…¹æ›¼åˆ†å¸ƒï¼Œå› ä¸ºé«˜æ–¯åˆ†å¸ƒæ›´å¥½å¤„ç†ä¸€äº›ã€‚</p>
<blockquote>
<p>ä½†æ˜¯è¿™æ ·ç›´æ¥ä¸¢å¤±äº†ç»å°”å…¹æ›¼åˆ†å¸ƒæ•è·å¤šå³°å‡½æ•°çš„èƒ½åŠ›</p>
</blockquote>
<p><span
class="math inline">\(Z\)</span>æ˜¯å½’ä¸€åŒ–å‡½æ•°ã€‚åœ¨ä¸Šå¼ä¸­ï¼Œæˆ‘ä»¬å…ˆå°†<span
class="math inline">\(Q^{\pi_{old}}_{soft}\)</span>æŒ‡æ•°åŒ–ä¸º<span
class="math inline">\(\exp(\alpha^{-1}{Q^{\pi_{old}}_{soft}})\)</span>å†å°†å…¶å½’ä¸€åŒ–ä¸ºåˆ†å¸ƒ<span
class="math inline">\(\frac{\exp
\left(Q^{\pi_{\mathrm{old}}}\left(\mathbf{s}_{t},
\cdot\right)\right)}{Z^{\pi_{\text {old
}}}\left(\mathbf{s}_{t}\right)}\)</span>ï¼Œå…¶ä¸­<span
class="math inline">\(Z^{\pi_{old}}(s_t)=\int
\exp(\alpha^{-1}{Q^{\pi_{old}}_{soft}})
da_t\)</span>ä¸ºå½’ä¸€åŒ–å‡½æ•°ã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªç­–ç•¥<span
class="math inline">\(\pi \prime\)</span>åœ¨çŠ¶æ€<span
class="math inline">\(s_t\)</span>ä¸‹çš„åŠ¨ä½œåˆ†å¸ƒä¸<span
class="math inline">\(\frac{\exp
\left(Q^{\pi_{\mathrm{old}}}\left(\mathbf{s}_{t},
\cdot\right)\right)}{Z^{\pi_{\text {old
}}}\left(\mathbf{s}_{t}\right)}\)</span>åˆ†å¸ƒçš„KL-divergenceæœ€å°
ï¼Œå³å¸Œæœ›<span class="math inline">\(\pi
\prime(\cdot|s_t)\)</span>ä¸åˆ†å¸ƒ<span class="math inline">\(\frac{\exp
\left(Q^{\pi_{\mathrm{old}}}\left(\mathbf{s}_{t},
\cdot\right)\right)}{Z^{\pi_{\text {old
}}}\left(\mathbf{s}_{t}\right)}\)</span>è¶Šç›¸ä¼¼è¶Šå¥½ã€‚é‡‡ç”¨æ™®é€šçš„ç­–ç•¥ä¼˜åŒ–åªä¼šåœ¨æœ€é«˜å³°æ»¡è¶³ç›¸ä¼¼æ€§ï¼Œè€Œsoftç­–ç•¥ä¼˜åŒ–ä¼šåœ¨æ•´ä¸ªåˆ†å¸ƒä¸Šå°½é‡ä¸ä»·å€¼å‡½æ•°ä¿æŒç›¸ä¼¼ï¼Œä¸ä»…ä¿è¯äº†èµ‹äºˆåŠ¨ä½œä»·å€¼æ›´é«˜çš„åŠ¨ä½œæ›´å¤§çš„æ¦‚ç‡ï¼Œè¿˜ä¿è¯äº†æ–°ç­–ç•¥å…·æœ‰è¾ƒå¤§çš„ç†µã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://pic1.zhimg.com/80/v2-d5fa72ff00bb69449928fba1e6911a8a_1440w.webp" srcset="/img/loading.gif" lazyload style="zoom: 33%;" /></p>
<h3 id="å‚æ•°åŒ–çš„sacç®—æ³•">4.2 å‚æ•°åŒ–çš„SACç®—æ³•</h3>
<p>ç±»ä¼¼Soft Q Learningï¼ŒSACä¹Ÿå°†ä»·å€¼å‡½æ•° $V_{}(_{t}) $ã€ <span
class="math inline">\(Q_{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\)</span> å’Œç­–ç•¥ <span
class="math inline">\(\pi_{\phi}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)\)</span> å‚æ•°åŒ–æ¥è¡¨è¾¾è¿ç»­åŸŸä¸æ–¹ä¾¿ä¼˜åŒ–ã€‚</p>
<p>1ï¼‰<strong>ä»·å€¼å‡½æ•°çš„ä¼˜åŒ–</strong></p>
<p>ä»·å€¼å‡½æ•°çš„ä¼˜åŒ–éƒ½ç±»ä¼¼DQNç®—æ³•ï¼Œé€šè¿‡æå°åŒ–Soft Bellman
residualå®ç°ï¼Œä¸‹å¼ä¸­<span
class="math inline">\(D\)</span>ä¸ºå›æ”¾ç¼“å†²åŒºï¼ˆReplay Bufferï¼‰ï¼š</p>
<p>ä¼˜åŒ–<span class="math inline">\(V\)</span>çš„ç›®æ ‡å‡½æ•°ï¼š</p>
<p><span class="math display">\[
J_{V}(\psi)=\mathbb{E}_{\mathbf{s}_{t} \sim
\mathcal{D}}\left[\frac{1}{2}\left(V_{\psi}\left(\mathbf{s}_{t}\right)-\mathbb{E}_{\mathbf{a}_{t}
\sim \pi_{\phi}}\left[Q_{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-\log \pi_{\phi}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)\right]\right)^{2}\right]
\]</span></p>
<p>éšæœºæ¢¯åº¦ï¼š</p>
<p><span class="math display">\[
\hat{\nabla}_{\psi} J_{V}(\psi)=\nabla_{\psi}
V_{\psi}\left(\mathbf{s}_{t}\right)\left(V_{\psi}\left(\mathbf{s}_{t}\right)-Q_{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)+\log \pi_{\phi}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)\right)
\]</span></p>
<p>ä¼˜åŒ–<span class="math inline">\(Q\)</span>çš„ç›®æ ‡å‡½æ•°ï¼š</p>
<p><span class="math display">\[
J_{Q}(\theta)=\mathbb{E}_{\left(\mathbf{s}_{t}, \mathbf{a}_{t}\right)
\sim \mathcal{D}}\left[\frac{1}{2}\left(Q_{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-\hat{Q}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\right)^{2}\right]
\]</span></p>
<p>å…¶ä¸­ï¼š</p>
<p><span class="math display">\[
\hat{Q}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)=r\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)+\gamma \mathbb{E}_{\mathbf{s}_{t+1} \sim
p}\left[V_{\bar{\psi}}\left(\mathbf{s}_{t+1}\right)\right]
\]</span></p>
<p>éšæœºæ¢¯åº¦ï¼š</p>
<p><span class="math display">\[
\hat{\nabla}_{\theta} J_{Q}(\theta)=\nabla_{\theta}
Q_{\theta}\left(\mathbf{a}_{t},
\mathbf{s}_{t}\right)\left(Q_{\theta}\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-r\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)-\gamma
V_{\bar{\psi}}\left(\mathbf{s}_{t+1}\right)\right)
\]</span></p>
<p>åŒæ ·ç”¨åˆ°äº†targetç½‘ç»œ<span
class="math inline">\(V_{\bar{\psi}}\)</span></p>
<p>2ï¼‰<strong>ç­–ç•¥çš„ä¼˜åŒ–</strong></p>
<p><strong>åŒæ ·ç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒé€šè¿‡KLæ•£åº¦è¿‘ä¼¼ç»å°”å…¹æ›¼åˆ†å¸ƒï¼š</strong> <span
class="math display">\[
J_{\pi}(\phi)=\mathbb{E}_{\mathbf{s}_{t} \sim
\mathcal{D}}\left[\mathrm{D}_{\mathrm{KL}}\left(\pi_{\phi}\left(\cdot
\mid \mathbf{s}_{t}\right) \| \frac{\exp
\left(Q_{\theta}\left(\mathbf{s}_{t},
\cdot\right)\right)}{Z_{\theta}\left(\mathbf{s}_{t}\right)}\right)\right]
\]</span></p>
<p>å¯¹æ­¤æœ‰ä¸¤ç§å¥½ç”¨çš„ä¼˜åŒ–æ–¹æ³•</p>
<ul>
<li><strong>ç­–ç•¥æ¢¯åº¦æ–¹æ³•</strong>ï¼šSACçš„ç­–ç•¥æ¢¯åº¦å‚è€ƒ<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/503393367">è¿™ç¯‡</a>ï¼Œæ˜¯å¯ä»¥æ¨å¯¼å‡ºæ¥çš„ã€‚</li>
<li><strong>é‡å‚æ•°åŒ–æŠ€å·§ï¼Œä¹Ÿæ˜¯SACå®é™…è¿ç”¨çš„æ–¹æ³•ï¼š</strong></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
D_{KL}(p||q)&amp;=H(p,q)-H(p)
\\ &amp;=- \sum_x p(x)\log q(x)- (-\sum_xp(x)\log p(x))
\\ &amp;=- \sum_x p(x)(\log q(x)-\log p(x))
\\ &amp;=- \sum_x p(x)\log \frac{q(x)}{p(x)}
\end{aligned}
\]</span></p>
æŠŠç­–ç•¥çš„ç›®æ ‡å‡½æ•°åŒ–ç®€ï¼š $$
<span class="math display">\[\begin{aligned}
&amp;\underset{\phi}{\operatorname{minimize}} D_{K
L}\left(\pi_\phi\left(\cdot \mid s_t\right) \|  \frac{\exp(\alpha
^{-1}Q_\theta\left(s_t, a_t\right))}{\exp(\log
\left(Z_\theta\left(s_t\right)\right))}\right)

\\&amp;=\underset{\phi}{\operatorname{minimize}} D_{K
L}\left(\pi_\phi\left(\cdot \mid s_t\right) \| \exp \left[\alpha
^{-1}Q_\theta\left(s_t, a_t\right)-\log
\left(Z_\theta\left(s_t\right)\right)\right]\right)

\\ &amp;=\underset{\phi}{\operatorname{minimize}} \sum_{a_t}\left[\log
\pi_\phi\left(a_t \mid s_t\right)-\alpha ^{-1}Q_\theta\left(s_t,
a_t\right)+\log \left(Z_\theta\left(s_t\right)\right]\right.

\\ &amp;=\underset{\phi}{\operatorname{minimize}} \underset{a_t \sim
\pi_\phi\left(\cdot| s_t\right)}{\mathbb{E}}\left[\log \pi_\phi\left(a_t
\mid s_t\right)-\alpha ^{-1}Q_\theta\left(s_t, a_t\right)+\log
\left(Z_\theta\left(s_t\right)\right]\right.

\\ &amp;=\underset{\phi}{\operatorname{minimize}} \underset{a_t \sim
\pi_\phi\left(\cdot| s_t\right)}{\mathbb{E}}\left[\alpha \log
\pi_\phi\left(a_t \mid s_t\right)-Q_\theta\left(s_t, a_t\right)\right]
\\ \end{aligned}\]</span>
<p>$$</p>
<p><span class="math display">\[
J_{\pi}(\phi)=E_{s_{t} \sim D, a_{t} \sim \pi_{\phi}}\left[\log
_{\pi_{\phi}}\left(a_{t} \mid s_{t}\right)-\frac{1}{\alpha}
Q_{\theta}\left(s_{t}, a_{t}\right)\right]
\]</span></p>
<p><strong>å¦‚æœç›´æ¥å¯¹å…¶æ±‚ç­–ç•¥æ¢¯åº¦çš„è¯ï¼Œæ˜¯ä¸èƒ½æŠŠç›´æ¥å¯¹æœŸæœ›é‡Œé¢çš„é¡¹æ±‚æ¢¯åº¦çš„ï¼Œå› ä¸ºæœŸæœ›åŒ…å«äº†ç­–ç•¥ï¼Œå› æ­¤å¿…é¡»å¯¹æœŸæœ›è¿›è¡Œè§£è€¦ï¼Œä½¿å…¶ä¸ç­–ç•¥æ— å…³</strong>ã€‚</p>
<p>ç›´æ¥æŠŠåŠ¨ä½œå»ºæ¨¡ä¸ºå–å†³äºå™ªå£°åˆ†å¸ƒå’ŒçŠ¶æ€åˆ†å¸ƒçš„ç½‘ç»œï¼š</p>
<p><span class="math display">\[
\mathbf{a}_{t}=f_{\phi}\left(\epsilon_{t} ; \mathbf{s}_{t}\right)
\]</span></p>
<p>å…¶ä¸­$ _{t} $æ˜¯å–è‡ªè¯¸å¦‚é«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ã€‚</p>
<p>å› æ­¤ç›®æ ‡å‡½æ•°å°±å˜ä¸ºï¼š</p>
<p><span class="math display">\[
J_{\pi}(\phi)=\mathbb{E}_{\mathbf{s}_{t} \sim \mathcal{D}, \epsilon_{t}
\sim \mathcal{N}}\left[\log \pi_{\phi}\left(f_{\phi}\left(\epsilon_{t} ;
\mathbf{s}_{t}\right) \mid
\mathbf{s}_{t}\right)-Q_{\theta}\left(\mathbf{s}_{t},
f_{\phi}\left(\epsilon_{t} ; \mathbf{s}_{t}\right)\right)\right]
\]</span></p>
<p>å¯ä»¥çœ‹åˆ°æœŸæœ›é‡Œçš„å™ªå£°åˆ†å¸ƒå’Œç­–ç•¥å‚æ•°è§£è€¦äº†</p>
<p>å› æ­¤å°±å¯ä»¥ç›´æ¥å¯¹å…¶æ±‚æ¢¯åº¦äº†ï¼Œä¸ç”¨ç®¡æœŸæœ›é‡Œçš„åˆ†å¸ƒäº†ï¼š</p>
<p><span class="math display">\[
\begin{aligned} \hat{\nabla}_{\phi} J_{\pi}(\phi)=\nabla_{\phi} \log
\pi_{\phi}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)d+\left(\nabla_{\mathbf{a}_{t}} \log
\pi_{\phi}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t}\right)-\nabla_{\mathbf{a}_{t}} Q\left(\mathbf{s}_{t},
\mathbf{a}_{t}\right)\right) \nabla_{\phi} f_{\phi}\left(\epsilon_{t} ;
\mathbf{s}_{t}\right) \end{aligned}
\]</span></p>
<blockquote>
<p>æ³¨æ„ï¼Œ<strong>ä¸ç”¨é‡å‚æ•°åŒ–æŠ€å·§ä¹Ÿå¯ä»¥</strong>ã€‚å¦‚æœç›´æ¥å¯¹æœŸæœ›æ±‚æ¢¯åº¦ä¹Ÿæ˜¯å¯ä»¥åšçš„ï¼Œé‚£æ ·å°±åˆ©ç”¨äº†ç­–ç•¥æ¢¯åº¦æ–¹æ³•çš„æ€æƒ³ã€‚<br />
é‡å‚æ•°åŒ–æŠ€å·§çš„é¢å¤–å¥½å¤„æ˜¯æ–¹å·®å°ï¼ŒSACç”¨é‡å‚æ•°åŒ–æŠ€å·§å…¶å®æ˜¯è¿™ä¸ªåŸå› ã€‚</p>
</blockquote>
<h3 id="sacç®—æ³•">4.3 SACç®—æ³•</h3>
<p>SACåˆä»åˆ«çš„ç®—æ³•é‡ŒæŠ„äº†å‡ ä¸ªtrickï¼Œæ¯”å¦‚TD3çš„åŒQç½‘ç»œå–æœ€å°ã€è¿˜æœ‰DQNçš„trickï¼Œä¸è¿‡è¿™äº›éƒ½ä¸é‡è¦ã€‚</p>
<p>ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œä»·å€¼å‡½æ•°å’Œç­–ç•¥çš„æ›´æ–°éƒ½äº†è§£äº†ï¼Œå¯ä»¥å†™å‡ºç®—æ³•äº†ï¼š</p>
<p><img
src="https://pic2.zhimg.com/v2-5c60331b84a610aef81ad3101ff2b2bb_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>SACç®—æ³•</p>
<h2 id="sac2è‡ªåŠ¨è°ƒæ•´æ¸©åº¦ç³»æ•°">5ã€SAC2ï¼šè‡ªåŠ¨è°ƒæ•´æ¸©åº¦ç³»æ•°</h2>
<p>SACç®—æ³•å¯¹äºæ¸©åº¦å‚æ•°éå¸¸æ•æ„Ÿï¼Œè€Œè°ƒæ•´çƒ­åº¦å‚æ•°æ˜¯åˆæ¯”è¾ƒå›°éš¾â€”â€”æˆ‘ä»¬æ€ä¹ˆç¡®å®šåœ¨æ¯ä¸€æ—¶åˆ»ç”¨ä»€ä¹ˆæ¸©åº¦å‚æ•°å‘¢ï¼Ÿåªéœ€è¦ä¿è¯æ¯ä¸€æ­¥çš„ç†µéƒ½ä¸ä½äºä¸€ä¸ªæœ€å°å€¼å°±è¡Œäº†ï¼Œå³æ±‚è§£å¦‚ä¸‹<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E7%BA%A6%E6%9D%9F%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98&amp;zhida_source=entity&amp;is_preview=1">çº¦æŸä¼˜åŒ–é—®é¢˜</a>ï¼š</p>
<p><span class="math display">\[
\max _{\pi_{0}, \ldots, \pi_{T}} \mathbb{E}\left[\sum_{t=0}^{T}
r\left(s_{t}, a_{t}\right)\right] \text { s.t. } \forall t,
\mathcal{H}\left(\pi_{t}\right) \geq \mathcal{H}_{0}
\]</span></p>
<p>å› ä¸ºåœ¨æ—¶åˆ»tçš„ç­–ç•¥ä¸ä¼šå½±å“åˆ°ä¹‹å‰æ—¶åˆ»çš„ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼åŠ¨æ€è§„åˆ’çš„æ€æƒ³ä»åå¾€å‰é€æ­¥æœ€å¤§åŒ–æ”¶ç›Šï¼š</p>
<p><span class="math display">\[
\max _{\pi 0}\left(\mathbb{E}\left[r\left(s_{0},
a_{0}\right)\right]+\max _{\pi_{1}}\left(\mathbb{E}[\ldots]+\max
_{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right)\right]\right)\right)
\]</span></p>
<p>æˆ‘ä»¬ä»æœ€åä¸€ä¸ªæ—¶åˆ»Tå¼€å§‹æœ€å¤§åŒ–ï¼š</p>
<p><span class="math display">\[
\mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi}}\left[r\left(s_{T}, a_{T}\right)\right] \text { s.t. }
\mathcal{H}\left(\pi_{T}\right)-\mathcal{H}_{0} \geq 0
\]</span></p>
<p>è¦æ±‚è§£è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°æ‹‰æ ¼æœ—æ—¥å¯¹å¶çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>æ‹‰æ ¼æœ—æ—¥å¯¹å¶è¿™ä¸ªå†™çš„éå¸¸å¥½ï¼š<a
href="https://link.zhihu.com/?target=https%3A//cs.stanford.edu/people/davidknowles/lagrangian_duality.pdf">ç¬¨è›‹éƒ½èƒ½çœ‹æ‡‚çš„æ‹‰æ ¼æœ—æ—¥å¯¹å¶</a><br />
çŸ¥é“äº†æ‹‰æ ¼æœ—æ—¥å¯¹å¶çš„åšæ³•ï¼Œå°±å¯ä»¥ç»§ç»­ä¸‹é¢çš„æ¨å¯¼å•¦</p>
</blockquote>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä»¥ä¸‹å‡½æ•°ï¼š</p>
<p><span class="math display">\[
\begin{aligned} h\left(\pi_{T}\right)
&amp;=\mathcal{H}\left(\pi_{T}\right)-\mathcal{H}_{0}=\mathbb{E}_{\left(s_{T},
a_{T}\right) \sim \rho_{\pi}}\left[-\log \pi_{T}\left(a_{T} \mid
s_{T}\right)\right]-\mathcal{H}_{0} \\ f\left(\pi_{T}\right) &amp;=
\begin{cases}\mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi}}\left[r\left(s_{T}, a_{T}\right)\right], &amp; \text { if }
h\left(\pi_{T}\right) \geq 0 \\ -\infty, &amp; \text { otherwise
}\end{cases} \end{aligned}
\]</span></p>
<p>äºæ˜¯ä¼˜åŒ–é—®é¢˜å°±å˜æˆäº†ï¼š</p>
<p><span class="math display">\[
f\left(\pi_{T}\right) \text { s.t. } h\left(\pi_{T}\right) \geq 0
\]</span></p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªä¸ç­‰å¼çº¦æŸçš„æœ€å¤§åŒ–ä¼˜åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå¸¦æœ‰<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E5%AD%90&amp;zhida_source=entity&amp;is_preview=1">æ‹‰æ ¼æœ—æ—¥ä¹˜å­</a>çš„è¡¨è¾¾å¼ï¼š</p>
<p><span class="math display">\[
L\left(\pi_{T}, \alpha_{T}\right)=f\left(\pi_{T}\right)+\alpha_{T}
h\left(\pi_{T}\right)
\]</span></p>
<p>å®é™…ä¸Šï¼Œç›®æ ‡å‡½æ•°å°±ç­‰ä»·äºæœ€å°åŒ–Lçš„<span
class="math inline">\(\alpha\)</span>çš„å¼å­ï¼š</p>
<p><span class="math display">\[
f\left(\pi_{T}\right)=\min _{\alpha_{T} \geq 0} L\left(\pi_{T},
\alpha_{T}\right)
\]</span></p>
<p>è¿™æ ·å†™çš„åŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¦‚æœçº¦æŸè¢«æ»¡è¶³ï¼Œé‚£ä¹ˆ <span class="math inline">\(\alpha\)</span>
æœ€å¥½å°†å…¶è®¾ç½®ä¸º0æ‰èƒ½è®©Læœ€å°ï¼ˆæ³¨æ„ $ $ ï¼‰ã€‚äºæ˜¯ã€‚</li>
<li>å¦‚æœçº¦æŸè¢«è¿èƒŒäº†ï¼Œå³ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¤<span
class="math inline">\(\alpha_{T} \rightarrow \infty\)</span>æ¥ä½¿å¾—$
L(<em>{T}, </em>{T}) -<span
class="math inline">\(ã€‚äºæ˜¯\)</span>L(<em>{T}, )=-=f(</em>{T})$ã€‚</li>
</ul>
<p><strong>ä¸Šé¢è¿™ä¸ªminä»…ä»…ä»£è¡¨çš„æ˜¯çº¦æŸæ¡ä»¶çš„æ»¡è¶³</strong></p>
<p><strong>ä¸ºäº†æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°è¿˜éœ€è¦ä¸€ä¸ªmaxçš„æ“ä½œï¼š</strong> <span
class="math display">\[
\max _{\pi_{T}} f\left(\pi_{T}\right)=\max _{\pi_{T}}\min _{\alpha_{T}
\geq 0} L\left(\pi_{T}, \alpha_{T}\right)
\]</span> ç°åœ¨æŠŠå®ƒå˜æˆæ›´å¥½å¤„ç†çš„å¯¹å¶é—®é¢˜ï¼š</p>
<p><span class="math display">\[
\begin{aligned} \max _{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right)\right] &amp;=\max _{\pi_{T}} f\left(\pi_{T}\right) \\
&amp;=\min _{\alpha_{T} \geq 0} \max _{\pi_{T}} L\left(\pi_{T},
\alpha_{T}\right) \\ &amp;=\min _{\alpha_{T} \geq 0} \max _{\pi_{T}}
f\left(\pi_{T}\right)+\alpha_{T} h\left(\pi_{T}\right) \\ &amp;=\min
_{\alpha_{T} \geq 0} \max _{\pi_{T}} \mathbb{E}_{\left(s_{T},
a_{T}\right) \sim \rho_{\pi}}\left[r\left(s_{T},
a_{T}\right)\right]+\alpha_{T}\left(\mathbb{E}_{\left(s_{T},
a_{T}\right) \sim \rho_{\pi}}\left[-\log \pi_{T}\left(a_{T} \mid
s_{T}\right)\right]-\mathcal{H}_{0}\right) \\ &amp;=\min _{\alpha_{T}
\geq 0} \max _{\pi_{T}} \mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi}}\left[r\left(s_{T}, a_{T}\right)-\alpha_{T} \log
\pi_{T}\left(a_{T} \mid s_{T}\right)\right]-\alpha_{T} \mathcal{H}_{0}
\\ &amp;=\min _{\alpha_{T} \geq 0} \max _{\pi_{T}}
\mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi}}\left[r\left(s_{T}, a_{T}\right)+\alpha_{T}
\mathcal{H}\left(\pi_{T}\right)-\alpha_{T} \mathcal{H}_{0}\right]
\end{aligned}
\]</span></p>
<blockquote>
<p>ç”±äºç›®æ ‡å‡½æ•°æ˜¯çº¿æ€§çš„ï¼Œç†µçº¦æŸæ˜¯<a
target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?q=%E5%87%B8%E5%87%BD%E6%95%B0&amp;zhida_source=entity&amp;is_preview=1">å‡¸å‡½æ•°</a>ï¼Œæ‰€ä»¥å¼ºå¯¹å¶æ€§æˆç«‹ã€‚<br />
è¿™æ„å‘³ç€å¯¹å¶é—®é¢˜çš„æœ€ä¼˜è§£ç­‰äºåŸå§‹é—®é¢˜çš„æœ€ä¼˜è§£ã€‚</p>
</blockquote>
<p>æ‰€ä»¥æœ€ä¼˜ç­–ç•¥å’Œæœ€ä¼˜æ¸©åº¦ç³»æ•°éƒ½å¯ä»¥è¡¨ç¤ºå‡ºæ¥äº†ï¼š</p>
<p><span class="math display">\[
\begin{aligned} &amp;\pi_{T}^{\star}=\arg \max _{\pi_{T}}
\mathbb{E}_{\left(s_{T}, a_{T}\right) \sim \rho_{\pi}}\left[\left(s_{T},
a_{T}\right)+\alpha_{T} \mathcal{H}\left(\pi_{T}\right)-\alpha_{T}
\mathcal{H}_{0}\right] \\ &amp;\alpha_{T}^{\star}=\arg \min _{\alpha_{T}
\geq 0} \mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi^{\star}}}\left[\alpha_{T}
\mathcal{H}\left(\pi_{T}^{\star}\right)-\alpha_{T}
\mathcal{H}_{0}\right] \end{aligned}
\]</span></p>
<p>æ‰€ä»¥ç›®æ ‡å‡½æ•°çš„æœ€å¤§åŒ–å®Œå…¨å¯ä»¥ç”¨æœ€ä¼˜ç­–ç•¥å’Œæ¸©åº¦ç³»æ•°è¡¨ç¤ºï¼š</p>
<p><span class="math display">\[
\max _{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right)\right]=\mathbb{E}_{\left(s_{T}, a_{T}\right) \sim
\rho_{\pi^{\star}}}\left[r\left(s_{T}, a_{T}\right)+\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right)-\alpha_{T}^{\star}
\mathcal{H}_{0}\right]
\]</span></p>
<p>æŠŠè¿™ä¸ªæ€æƒ³ç”¨åˆ°Qå‡½æ•°ä¸­ï¼Œé‚£ä¹ˆQå‡½æ•°ä¹Ÿå¯ä»¥è¿™ä¹ˆè¡¨ç¤ºï¼š</p>
<p><span class="math display">\[
\begin{aligned} Q_{T-1}\left(s_{T-1}, a_{T-1}\right)
&amp;=r\left(s_{T-1}, a_{T-1}\right)+\mathbb{E}\left[Q\left(s_{T},
a_{T}\right)-\alpha_{T} \log \pi\left(a_{T} \mid s_{T}\right)\right] \\
&amp;=r\left(s_{T-1}, a_{T-1}\right)+\mathbb{E}\left[r\left(s_{T},
a_{T}\right)\right]+\alpha_{T} \mathcal{H}\left(\pi_{T}\right) \\
Q_{T-1}^{\star}\left(s_{T-1}, a_{T-1}\right) &amp;=r\left(s_{T-1},
a_{T-1}\right)+\max _{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right)\right]+\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right) \end{aligned}
\]</span>
å› æ­¤,å›æº¯åˆ°T-1æ­¥ï¼ŒæŠŠæœ€ä¼˜Qçš„å¼å­å¸¦è¿›å»ï¼Œå½¢æˆäº†å¦ä¸€ä¸ªçº¦æŸä¼˜åŒ–é—®é¢˜</p>
<p><span class="math display">\[
\begin{aligned} &amp;\max
_{\pi_{T-1}}\left(\mathbb{E}\left[r\left(s_{T-1},
a_{T-1}\right)\right]+\max _{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right]\right)\right. \\ &amp;=\max
_{\pi_{T-1}}\left(Q_{T-1}^{\star}\left(s_{T-1},
a_{T-1}\right)-\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right)\right),s.t.\mathcal{H}\left(\pi_{T-1}\right)-\mathcal{H}_{0}
\geq 0 \end{aligned}
\]</span></p>
<p>åŒæ ·ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶ï¼š</p>
<p><span class="math display">\[
\begin{aligned} &amp;\max
_{\pi_{T-1}}\left(\mathbb{E}\left[r\left(s_{T-1},
a_{T-1}\right)\right]+\max _{\pi_{T}} \mathbb{E}\left[r\left(s_{T},
a_{T}\right]\right)\right. \\ &amp;=\max
_{\pi_{T-1}}\left(Q_{T-1}^{\star}\left(s_{T-1},
a_{T-1}\right)-\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right)\right) \\ &amp;=\min
_{\alpha_{T-1} \geq 0} \max
_{\pi_{T-1}}\left(Q_{T-1}^{\star}\left(s_{T-1},
a_{T-1}\right)-\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right)+\alpha_{T-1}\left(\mathcal{H}\left(\pi_{T-1}\right)-\mathcal{H}_{0}\right)\right)
\\ &amp;=\min _{\alpha_{T-1} \geq 0} \max
_{\pi_{T-1}}\left(Q_{T-1}^{\star}\left(s_{T-1},
a_{T-1}\right)+\alpha_{T-1}
\mathcal{H}\left(\pi_{T-1}\right)-\alpha_{T-1}
\mathcal{H}_{0}\right)-\alpha_{T}^{\star}
\mathcal{H}\left(\pi_{T}^{\star}\right) \end{aligned}
\]</span> ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°T-1æ­¥çš„æœ€ä¼˜ç­–ç•¥å’Œæœ€ä¼˜æ¸©åº¦ç³»æ•°ï¼š</p>
<p><span class="math display">\[
\begin{aligned} \pi_{T-1}^{\star} &amp;=\arg \max _{\pi_{T-1}}
\mathbb{E}_{\left(s_{T-1} a_{T-1}\right) \sim
\rho_{\pi}}\left[Q_{T-1}^{\star}\left(s_{T-1},
a_{T-1}\right)+\alpha_{T-1}
\mathcal{H}\left(\pi_{T-1}\right)-\alpha_{T-1} \mathcal{H}_{0}\right] \\
\alpha_{T-1}^{\star} &amp;=\arg \min _{\alpha_{T-\mathbb{Z}}}
\mathbb{E}_{\left(s_{T-1} a_{T-1}\right) \sim
\rho_{\pi^{\star}}}\left[\alpha_{T-1}
\mathcal{H}\left(\pi_{T-1}^{\star}\right)-\alpha_{T-1}
\mathcal{H}_{0}\right] \end{aligned}
\]</span></p>
<p>äºæ˜¯ï¼Œåœ¨æ¯ä¸€æ­¥æˆ‘ä»¬éƒ½èƒ½å¤Ÿæœ€å°åŒ–ä»¥ä¸‹ç›®æ ‡å‡½æ•°ä»¥æ±‚è§£æ¸©åº¦ç³»æ•°ï¼š</p>
<p><span class="math display">\[
J(\alpha)=\mathbb{E}_{a_{t} \sim \pi_{t}}\left[-\alpha \log
\pi_{t}\left(a_{t} \mid \pi_{t}\right)-\alpha \mathcal{H}_{0}\right]
\]</span></p>
<p>å¹¶å¾—åˆ°æœ€ä¼˜æ¸©åº¦ç³»æ•°ï¼š</p>
<p><span class="math display">\[
\alpha_{t}^{*}=\arg \min _{\alpha_{t}} \mathbb{E}_{\mathbf{a}_{t} \sim
\pi_{t}^{*}}\left[-\alpha_{t} \log \pi_{t}^{*}\left(\mathbf{a}_{t} \mid
\mathbf{s}_{t} ; \alpha_{t}\right)-\alpha_{t}
\overline{\mathcal{H}}\right]
\]</span></p>
<p>ç»¼ä¸Šï¼ŒæŠŠç†µçš„è‡ªåŠ¨æ±‚è§£æ”¾å…¥SACä¸­ï¼Œå°±å½¢æˆäº†SAC2ç®—æ³•ï¼š</p>
<p><img
src="https://pic1.zhimg.com/v2-562d7f3a5bced03cec813668ab178eac_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>SAC2</p>
<h2 id="sac-ç¦»æ•£">6ã€SAC-ç¦»æ•£</h2>
<p>SACå½“ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æƒ³æ³•ï¼Œåœ¨å¾ˆå¤šè¿ç»­åŠ¨ä½œç©ºé—´çš„ä»»åŠ¡ä¸Šéƒ½è¾¾åˆ°äº†SOTAï¼Œä¸è¿‡å¹¶ä¸æ˜¯å¾ˆé€‚åˆç¦»æ•£åŠ¨ä½œç©ºé—´ã€‚</p>
<p>ä¸ºäº†é€‚åº”ç¦»æ•£åŠ¨ä½œç©ºé—´ï¼Œå¿…é¡»è¦åšå‡ºä»¥ä¸‹äº”ä¸ªæ”¹å˜ï¼š</p>
<ul>
<li><strong>Qå‡½æ•°è¾“å‡ºæ‰€æœ‰çš„çŠ¶æ€åŠ¨ä½œ</strong>ã€‚è¿™åœ¨è¿ç»­çŠ¶æ€ç©ºé—´æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºåŠ¨ä½œæ˜¯è¿ç»­çš„ã€‚åœ¨ç¦»æ•£åŠ¨ä½œç©ºé—´ä¸­è¿™ç§æƒ…å†µå°±æˆä¸ºäº†æé«˜æ•ˆç‡çš„ä¸€ç§å¯èƒ½æ–¹æ³•ã€‚</li>
<li><strong>ç­–ç•¥å‡½æ•°ä¸è¾“å‡ºå‡å€¼å’Œæ–¹å·®ï¼Œç›´æ¥è¾“å‡ºåŠ¨ä½œåˆ†å¸ƒ</strong>ã€‚è¿™æ˜¯ç¦»æ•£åŠ¨ä½œç©ºé—´çš„å¿…ç„¶è¦æ±‚ã€‚</li>
<li><strong>å¯¹æ±‚VåŠ¨ä½œçš„æœŸæœ›æ”¹æˆç§¯åˆ†</strong>ã€‚ä¹‹å‰æ±‚Vçš„æ—¶å€™éœ€è¦å¯¹åŠ¨ä½œæ±‚æœŸæœ›ï¼š$V(s_{t}):=E_{a_{t}
}<span
class="math inline">\(ï¼Œä¸è¿‡åœ¨ç¦»æ•£åŠ¨ä½œç©ºé—´ï¼Œæ‰€æœ‰åŠ¨ä½œçš„ç§¯åˆ†æ˜¯å¯ä»¥æ±‚å¾—çš„ï¼Œå› æ­¤å˜æœŸæœ›ä¸ºç§¯åˆ†ä»¥å‡å°‘æ–¹å·®ï¼š\)</span>V(s_{t}):=(s_{t})^{T}$</li>
<li><strong>åŒæ ·çš„ï¼Œå¯¹æ¸©åº¦ç³»æ•°çš„åŠ¨ä½œæœŸæœ›æ”¹æˆç§¯åˆ†</strong>ã€‚<span
class="math inline">\(J(\alpha)=\pi_{t}\left(s_{t}\right)^{T}\left[-\alpha\left(\log
\left(\pi_{t}\left(s_{t}\right)\right)+\bar{H}\right)\right]\)</span></li>
<li><strong>å»æ‰é‡å‚æ•°åŒ–</strong>ã€‚ä¹‹å‰ä½¿ç”¨é‡å‚æ•°åŒ–çš„ä¸€ä¸ªåŸå› æ˜¯æœŸæœ›é‡Œå¸¦åŠ¨ä½œåˆ†å¸ƒï¼Œå› æ­¤æ¢¯åº¦ä¸èƒ½ä»æœŸæœ›å¤–ç›´æ¥æåˆ°æœŸæœ›å†…ã€‚ä½†æ˜¯ç°åœ¨åŠ¨ä½œå·²ç»å˜æˆç§¯åˆ†/æ±‚å’Œå½¢å¼äº†ï¼Œæ¯ä¸ªåŠ¨ä½œéƒ½èƒ½ç›´æ¥è®¡ç®—å‡ºæ¥ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å¯¹ä»¥ä¸‹ç›®æ ‡å‡½æ•°æ±‚æ¢¯åº¦ï¼š<span
class="math inline">\(J_{\pi}(\phi)=E_{s_{t} \sim
D}\left[\pi_{t}\left(s_{t}\right)^{T}\left[\alpha \log
\left(\pi_{\phi}\left(s_{t}\right)\right)-Q_{\theta}\left(s_{t}\right)\right]\right]\)</span></li>
</ul>
<p>è¿™äº”ç‚¹æ„æˆäº†ç¦»æ•£SACç®—æ³•ï¼š</p>
<p><img
src="https://pic3.zhimg.com/v2-1c5c687228798d928f0c5ce178fef97e_b.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>ç¦»æ•£SAC</p>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/557418338">ä»Soft Q
Learningåˆ°SAC - çŸ¥ä¹ (zhihu.com)</a></p>
<script src="https://utteranc.es/client.js"
        repo="Antonalia/antonalia.github.io"
        issue-term="pathname"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/" class="category-chain-item">å¼ºåŒ–å­¦ä¹ </a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/SAC%E7%AE%97%E6%B3%95/" class="print-no-link">#SACç®—æ³•</a>
      
        <a href="/tags/Actor-Critic%E7%AE%97%E6%B3%95/" class="print-no-link">#Actor-Criticç®—æ³•</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>SACç®—æ³•</div>
      <div>http://example.com/04SAC/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>ä»“é¼ å°ä¹</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´9æœˆ4æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/05property-function/" title="Pythonä¸­propertyå’Œ@propertyçš„åº”ç”¨">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Pythonä¸­propertyå’Œ@propertyçš„åº”ç”¨</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/03normalization/" title="å½’ä¸€åŒ–ã€æ ‡å‡†åŒ–ã€æ­£åˆ™åŒ–">
                        <span class="hidden-mobile">å½’ä¸€åŒ–ã€æ ‡å‡†åŒ–ã€æ­£åˆ™åŒ–</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <div> <span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span> <script src="/js/duration.js"></script> </div>
<a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/Snowflake.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>

<!--å•å‡»æ˜¾ç¤ºæ–‡å­—-->
<script type="text/javascript" src="/js/click_show_text.js"></script>



